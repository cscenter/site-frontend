(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"1aPi":function(t,e,i){"use strict";var a=i("gDU4"),n=i("fw2E"),r=function(){return n.a.Date.now()},o=i("G12H"),s=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;var d=function(t){if("number"==typeof t)return t;if(Object(o.a)(t))return NaN;if(Object(a.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(a.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var i=h.test(t);return i||l.test(t)?u(t.slice(2),i?2:8):c.test(t)?NaN:+t},p=Math.max,f=Math.min;e.a=function(t,e,i){var n,o,s,c,h,l,u=0,m=!1,g=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var i=n,a=o;return n=o=void 0,u=e,c=t.apply(a,i)}function w(t){return u=t,h=setTimeout(x,e),m?y(t):c}function b(t){var i=t-l;return void 0===l||i>=e||i<0||g&&t-u>=s}function x(){var t=r();if(b(t))return A(t);h=setTimeout(x,function(t){var i=e-(t-l);return g?f(i,s-(t-u)):i}(t))}function A(t){return h=void 0,v&&n?y(t):(n=o=void 0,c)}function C(){var t=r(),i=b(t);if(n=arguments,o=this,l=t,i){if(void 0===h)return w(l);if(g)return clearTimeout(h),h=setTimeout(x,e),y(l)}return void 0===h&&(h=setTimeout(x,e)),c}return e=d(e)||0,Object(a.a)(i)&&(m=!!i.leading,s=(g="maxWait"in i)?p(d(i.maxWait)||0,e):s,v="trailing"in i?!!i.trailing:v),C.cancel=function(){void 0!==h&&clearTimeout(h),u=0,n=l=o=h=void 0},C.flush=function(){return void 0===h?c:A(r())},C}},"244q":function(t,e,i){var a;
/*! FileAPI 2.1.1 - BSD | git://github.com/mailru/FileAPI.git
 * FileAPI — a set of  javascript tools for working with files. Multiupload, drag'n'drop and chunked file upload. Images: crop, resize and auto orientation by EXIF.
 */!function(t){"use strict";var e=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,i=t.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),a=i&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),n=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,r=(i||n)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(t){var e,r,o,s,c,h;for(e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),r=new ArrayBuffer(e.length),o=new Uint8Array(r),s=0;s<e.length;s+=1)o[s]=e.charCodeAt(s);return c=t.split(",")[0].split(":")[1].split(";")[0],i?new Blob([a?o:r],{type:c}):((h=new n).append(r),h.getBlob(c))};t.HTMLCanvasElement&&!e.toBlob&&(e.mozGetAsFile?e.toBlob=function(t,i,a){a&&e.toDataURL&&r?t(r(this.toDataURL(i,a))):t(this.mozGetAsFile("blob",i))}:e.toDataURL&&r&&(e.toBlob=function(t,e,i){t(r(this.toDataURL(e,i)))})),t.dataURLtoBlob=r}(window),function(t,e){"use strict";var i,a,n=1,r=function(){},o=t.document,s=o.doctype||{},c=t.navigator.userAgent,h=/safari\//i.test(c)&&!/chrome\//i.test(c),l=/iemobile\//i.test(c),u=!h&&/chrome\//i.test(c)&&"http:"===t.location.protocol,d=t.createObjectURL&&t||t.URL&&URL.revokeObjectURL&&URL||t.webkitURL&&webkitURL,p=t.Blob,f=t.File,m=t.FileReader,g=t.FormData,v=t.XMLHttpRequest,y=t.jQuery,w=!(!(f&&m&&(t.Uint8Array||g||v.prototype.sendAsBinary))||h&&/windows/i.test(c)&&!l),b=w&&"withCredentials"in new v,x=w&&!!p&&!!(p.prototype.webkitSlice||p.prototype.mozSlice||p.prototype.slice),A=(""+"".normalize).indexOf("[native code]")>0,C=t.dataURLtoBlob,D=/img/i,I=/canvas/i,M=/img|canvas/i,T=/input/i,F=/^data:[^,]+,/,k={}.toString,E=t.Math,B=function(e){return(e=new t.Number(E.pow(1024,e))).from=function(t){return E.round(t*this)},e},O={},R=[],j="abort progress error load loadend",L="status statusText readyState response responseXML responseText responseBody".split(" "),S=function(t){return t&&"length"in t},P=function(t,e,i){if(t)if(S(t))for(var a=0,n=t.length;a<n;a++)a in t&&e.call(i,t[a],a,t);else for(var r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)},z=function(t){for(var e=arguments,i=1,a=function(e,i){t[i]=e};i<e.length;i++)P(e[i],a);return t},H=function(t,e,i){if(t){var a=X.uid(t);O[a]||(O[a]={});var n=m&&t&&t instanceof m;P(e.split(/\s+/),(function(e){y&&!n?y.event.add(t,e,i):(O[a][e]||(O[a][e]=[]),O[a][e].push(i),t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i)}))}},N=function(t,e,i){if(t){var a=X.uid(t),n=O[a]||{},r=m&&t&&t instanceof m;P(e.split(/\s+/),(function(e){if(y&&!r)y.event.remove(t,e,i);else{for(var a=n[e]||[],o=a.length;o--;)if(a[o]===i){a.splice(o,1);break}t.addEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null}}))}},U=function(t,e,i){H(t,e,(function a(n){N(t,e,a),i(n)}))},_=function(e){return e.target||(e.target=t.event&&t.event.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e},W=function(t){var e=o.createElement("input");return e.setAttribute("type","file"),t in e},X={version:"2.1.1",cors:!1,html5:!0,media:!1,formData:!0,multiPassResize:!0,insecureChrome:u,debug:!1,pingUrl:!1,multiFlash:!1,flashAbortTimeout:0,withCredentials:!0,staticPath:"./dist/",flashUrl:0,flashImageUrl:0,postNameConcat:function(t,e){return t+(null!=e?"["+e+"]":"")},ext2mime:{jpg:"image/jpeg",tif:"image/tiff",txt:"text/plain"},accept:{"image/*":"art bm bmp dwg dxf cbr cbz fif fpx gif ico iefs jfif jpe jpeg jpg jps jut mcf nap nif pbm pcx pgm pict pm png pnm qif qtif ras rast rf rp svf tga tif tiff xbm xbm xpm xwd","audio/*":"m4a flac aac rm mpa wav wma ogg mp3 mp2 m3u mod amf dmf dsm far gdm imf it m15 med okt s3m stm sfx ult uni xm sid ac3 dts cue aif aiff wpl ape mac mpc mpp shn wv nsf spc gym adplug adx dsp adp ymf ast afc hps xs","video/*":"m4v 3gp nsv ts ty strm rm rmvb m3u ifo mov qt divx xvid bivx vob nrg img iso pva wmv asf asx ogm m2v avi bin dat dvr-ms mpg mpeg mp4 mkv avc vp3 svq3 nuv viv dv fli flv wpl"},uploadRetry:0,networkDownRetryTimeout:5e3,chunkSize:0,chunkUploadRetry:0,chunkNetworkDownRetryTimeout:2e3,KB:B(1),MB:B(2),GB:B(3),TB:B(4),EMPTY_PNG:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NkAAIAAAoAAggA9GkAAAAASUVORK5CYII=",expando:"fileapi"+(new Date).getTime(),uid:function(t){return t?t[X.expando]=t[X.expando]||X.uid():(++n,X.expando+n)},log:function(){X.debug&&i&&(a?console.log.apply(console,arguments):console.log([].join.call(arguments," ")))},newImage:function(t,e){var i=o.createElement("img");return e&&X.event.one(i,"error load",(function(t){e("error"==t.type,i),i=null})),i.src=t,i},getXHR:function(){var e;if(v)e=new v;else if(t.ActiveXObject)try{e=new ActiveXObject("MSXML2.XMLHttp.3.0")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}return e},isArray:S,support:{dnd:b&&"ondrop"in o.createElement("div"),cors:b,html5:w,chunked:x,dataURI:!0,accept:W("accept"),multiple:W("multiple")},event:{on:H,off:N,one:U,fix:_},throttle:function(e,i){var a,n;return function(){n=arguments,a||(e.apply(t,n),a=setTimeout((function(){a=0,e.apply(t,n)}),i))}},F:function(){},parseJSON:function(e){return t.JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e.replace(/([\r\n])/g,"\\$1")+");")()},trim:function(t){return(t=String(t)).trim?t.trim():t.replace(/^\s+|\s+$/g,"")},defer:function(){var t,e,i=[],a={resolve:function(n,o){for(a.resolve=r,e=n||!1,t=o;o=i.shift();)o(e,t)},then:function(a){void 0!==e?a(e,t):i.push(a)}};return a},queue:function(t){var e=0,i=0,a=!1,n=!1,r={inc:function(){i++},next:function(){e++,setTimeout(r.check,0)},check:function(){e>=i&&!a&&r.end()},isFail:function(){return a},fail:function(){!a&&t(a=!0)},end:function(){n||(n=!0,t())}};return r},each:P,afor:function(t,e){var i=0,a=t.length;S(t)&&a--?function n(){e(a!=i&&n,t[i],i++)}():e(!1)},extend:z,isFile:function(t){return"[object File]"===k.call(t)},isBlob:function(t){return this.isFile(t)||"[object Blob]"===k.call(t)},isCanvas:function(t){return t&&I.test(t.nodeName)},getFilesFilter:function(t){return(t="string"==typeof t?t:t.getAttribute&&t.getAttribute("accept")||"")?new RegExp("("+t.replace(/\./g,"\\.").replace(/,/g,"|")+")$","i"):/./},readAsDataURL:function(t,e){X.isCanvas(t)?q(t,e,"load",X.toDataURL(t)):G(t,e,"DataURL")},readAsBinaryString:function(t,e){Y("BinaryString")?G(t,e,"BinaryString"):G(t,(function(t){if("load"==t.type)try{t.result=X.toBinaryString(t.result)}catch(e){t.type="error",t.message=e.toString()}e(t)}),"DataURL")},readAsArrayBuffer:function(t,e){G(t,e,"ArrayBuffer")},readAsText:function(t,e,i){i||(i=e,e="utf-8"),G(t,i,"Text",e)},toDataURL:function(t,e){return"string"==typeof t?t:t.toDataURL?t.toDataURL(e||"image/png"):void 0},toBinaryString:function(e){return t.atob(X.toDataURL(e).replace(F,""))},readAsImage:function(t,e,i){if(X.isBlob(t))if(d){var a=d.createObjectURL(t);void 0===a?q(t,e,"error"):X.readAsImage(a,e,i)}else X.readAsDataURL(t,(function(a){"load"==a.type?X.readAsImage(a.result,e,i):(i||"error"==a.type)&&q(t,e,a,null,{loaded:a.loaded,total:a.total})}));else if(X.isCanvas(t))q(t,e,"load",t);else if(D.test(t.nodeName))if(t.complete)q(t,e,"load",t);else{U(t,"error abort load",(function i(a){"load"==a.type&&d&&d.revokeObjectURL(t.src),N(t,"error abort load",i),q(t,e,a,t)}))}else if(t.iframe)q(t,e,{type:"error"});else{var n=X.newImage(t.dataURL||t);X.readAsImage(n,e,i)}},checkFileObj:function(t){var e={},i=X.accept;return"object"==typeof t?e=t:e.name=(t+"").split(/\\|\//g).pop(),null==e.type&&(e.type=e.name.split(".").pop()),P(i,(function(t,i){((t=new RegExp(t.replace(/\s/g,"|"),"i")).test(e.type)||X.ext2mime[e.type])&&(e.type=X.ext2mime[e.type]||i.split("/")[0]+"/"+e.type)})),e},getDropFiles:function(t,e){var i,a=[],n=[],r=V(t),o=r.files,s=r.items,c=S(s)&&s[0]&&K(s[0]),l=X.queue((function(){e(a,n)}));if(c)if(A&&o){var u,d,p=o.length;for(i=new Array(p);p--;){u=o[p];try{d=K(s[p])}catch(t){X.log("[err] getDropFiles: ",t),d=null}$(d)&&(d.isDirectory||d.isFile&&u.name==u.name.normalize("NFC"))?i[p]=d:i[p]=u}}else i=s;else i=o;P(i||[],(function(t){l.inc();try{c&&$(t)?function t(e,i){if(e)if(e.isFile)e.file((function(t){t.fullPath=e.fullPath,i(!1,[t],[t])}),(function(t){e.error=t,i("FileError.code: "+t.code,[],[e])}));else if(e.isDirectory){var a=e.createReader(),n=!0,r=[],o=[e],s=function(t){e.error=t,i("DirectoryError.code: "+t.code,r,o)},c=function c(h){n&&(n=!1,h.length||(e.error=new Error("directory is empty"))),h.length?X.afor(h,(function(e,i){t(i,(function(t,i,n){t||(r=r.concat(i)),o=o.concat(n),e?e():a.readEntries(c,s)}))})):i(!1,r,o)};a.readEntries(c,s)}else t(K(e),i);else{var h=new Error("invalid entry");(e=new Object(e)).error=h,i(h.message,[],[e])}}(t,(function(t,e,i){t?X.log("[err] getDropFiles:",t):a.push.apply(a,e),n.push.apply(n,i),l.next()})):function(t,e){if(!t.type&&(h||t.size%4096==0&&t.size<=102400))if(m)try{var i=new m;U(i,j,(function(t){var a="error"!=t.type;a?(null!=i.readyState&&i.readyState!==i.LOADING||i.abort(),e(a)):e(!1,i.error)})),i.readAsDataURL(t)}catch(t){e(!1,t)}else e(null,new Error("FileReader is not supported"));else e(!0)}(t,(function(e,i){e?a.push(t):t.error=i,n.push(t),l.next()}))}catch(t){l.next(),X.log("[err] getDropFiles: ",t)}})),l.check()},getFiles:function(t,e,i){var a=[];return i?(X.filterFiles(X.getFiles(t),e,i),null):(t.jquery&&(t.each((function(){a=a.concat(X.getFiles(this))})),t=a,a=[]),"string"==typeof e&&(e=X.getFilesFilter(e)),t.originalEvent?t=_(t.originalEvent):t.srcElement&&(t=_(t)),t.dataTransfer?t=t.dataTransfer:t.target&&(t=t.target),t.files?(a=t.files,w||(a[0].blob=t,a[0].iframe=!0)):!w&&Q(t)?X.trim(t.value)&&((a=[X.checkFileObj(t.value)])[0].blob=t,a[0].iframe=!0):S(t)&&(a=t),X.filter(a,(function(t){return!e||e.test(t.name)})))},getTotalSize:function(t){for(var e=0,i=t&&t.length;i--;)e+=t[i].size;return e},getInfo:function(t,e){var i={},a=R.concat();X.isBlob(t)?function n(){var r=a.shift();r?r.test(t.type)?r(t,(function(t,a){t?e(t):(z(i,a),n())})):n():e(!1,i)}():e("not_support_info",i)},addInfoReader:function(t,e){e.test=function(e){return t.test(e)},R.push(e)},filter:function(t,e){for(var i,a=[],n=0,r=t.length;n<r;n++)n in t&&(i=t[n],e.call(i,i,n,t)&&a.push(i));return a},filterFiles:function(t,e,i){if(t.length){var a,n=t.concat(),r=[],o=[];!function t(){n.length?(a=n.shift(),X.getInfo(a,(function(i,n){(e(a,!i&&n)?r:o).push(a),t()}))):i(r,o)}()}else i([],t)},upload:function(t){(t=z({jsonp:"callback",prepare:X.F,beforeupload:X.F,upload:X.F,fileupload:X.F,fileprogress:X.F,filecomplete:X.F,progress:X.F,complete:X.F,pause:X.F,imageOriginal:!0,chunkSize:X.chunkSize,chunkUploadRetry:X.chunkUploadRetry,uploadRetry:X.uploadRetry},t)).imageAutoOrientation&&!t.imageTransform&&(t.imageTransform={rotate:"auto"});var e,i=new X.XHR(t),a=this._getFilesDataArray(t.files),n=this,o=0,s=0,c=!1;return P(a,(function(t){o+=t.size})),i.files=[],P(a,(function(t){i.files.push(t.file)})),i.total=o,i.loaded=0,i.filesLeft=a.length,t.beforeupload(i,t),e=function(){var h,l=a.shift(),u=l&&l.file,d=!1,p=(h={},P(t,(function(t,e){t&&"object"==typeof t&&void 0===t.nodeType&&(t=z({},t)),h[e]=t})),h);if(i.filesLeft=a.length,u&&u.name===X.expando&&(u=null,X.log("[warn] FileAPI.upload() — called without files")),("abort"!=i.statusText||i.current)&&l){if(c=!1,i.currentFile=u,u&&!1===t.prepare(u,p))return void e.call(n);p.file=u,n._getFormData(p,l,(function(c){s||t.upload(i,t);var h=new X.XHR(z({},p,{upload:u?function(){t.fileupload(u,h,p)}:r,progress:u?function(e){d||(d=e.loaded===e.total,t.fileprogress({type:"progress",total:l.total=e.total,loaded:l.loaded=e.loaded},u,h,p),t.progress({type:"progress",total:o,loaded:i.loaded=s+l.size*(e.loaded/e.total)||0},u,h,p))}:r,complete:function(a){P(L,(function(t){i[t]=h[t]})),u&&(l.total=l.total||l.size,l.loaded=l.total,a||(this.progress(l),d=!0,s+=l.size,i.loaded=s),t.filecomplete(a,h,u,p)),setTimeout((function(){e.call(n)}),0)}}));i.abort=function(t){t||(a.length=0),this.current=t,h.abort()},h.send(c)}))}else{var f=200==i.status||201==i.status||204==i.status;t.complete(!f&&(i.statusText||"error"),i,t),c=!0}},setTimeout(e,0),i.append=function(t,r){t=X._getFilesDataArray([].concat(t)),P(t,(function(t){o+=t.size,i.files.push(t.file),r?a.unshift(t):a.push(t)})),i.statusText="",c&&e.call(n)},i.remove=function(t){for(var e,i=a.length;i--;)a[i].file==t&&(e=a.splice(i,1),o-=e.size);return e},i},_getFilesDataArray:function(t){var e=[],i={};if(Q(t)){var a=X.getFiles(t);i[t.name||"file"]=null!==t.getAttribute("multiple")?a:a[0]}else S(t)&&Q(t[0])?P(t,(function(t){i[t.name||"file"]=X.getFiles(t)})):i=t;return P(i,(function t(i,a){S(i)?P(i,(function(e){t(e,a)})):i&&(i.name||i.image)&&e.push({name:a,file:i,size:i.size,total:i.size,loaded:0})})),e.length||e.push({file:{name:X.expando}}),e},_getFormData:function(t,e,i){var a=e.file,n=e.name,r=a.name,o=a.type,s=X.support.transform&&t.imageTransform,c=new X.Form,h=X.queue((function(){i(c)})),l=s&&function(t){var e;for(e in t)if(t.hasOwnProperty(e)&&!(t[e]instanceof Object||"overlay"===e||"filter"===e))return!0;return!1}(s),u=X.postNameConcat;P(t.data,(function t(e,i){"object"==typeof e?P(e,(function(e,a){t(e,u(i,a))})):c.append(i,e)})),function e(i){i.image?(h.inc(),i.toData((function(t,a){i.file&&(a.type=i.file.type,a.quality=i.matrix.quality,r=i.file&&i.file.name),r=r||(new Date).getTime()+".png",e(a),h.next()}))):X.Image&&s&&(/^image/.test(i.type)||M.test(i.nodeName))?(h.inc(),l&&(s=[s]),X.Image.transform(i,s,t.imageAutoOrientation,(function(e,a){if(l&&!e)C||X.flashEngine||(c.multipart=!0),c.append(n,a[0],r,s[0].type||o);else{var d=0;e||P(a,(function(t,e){C||X.flashEngine||(c.multipart=!0),s[e].postName||(d=1),c.append(s[e].postName||u(n,e),t,r,s[e].type||o)})),(e||t.imageOriginal)&&c.append(u(n,d?"original":null),i,r,o)}h.next()}))):r!==X.expando&&c.append(n,i,r)}(a),h.check()},reset:function(t,e){var i,a;return y?(a=y(t).clone(!0).insertBefore(t).val("")[0],e||y(t).remove()):(i=t.parentNode,(a=i.insertBefore(t.cloneNode(!0),t)).value="",e||i.removeChild(t),P(O[X.uid(t)],(function(e,i){P(e,(function(e){N(t,i,e),H(a,i,e)}))}))),a},load:function(t,e){var i=X.getXHR();return i?(i.open("GET",t,!0),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),H(i,"progress",(function(t){t.lengthComputable&&e({type:t.type,loaded:t.loaded,total:t.total},i)})),i.onreadystatechange=function(){if(4==i.readyState)if(i.onreadystatechange=null,200==i.status){var a={name:(t=t.split("/"))[t.length-1],size:i.getResponseHeader("Content-Length"),type:i.getResponseHeader("Content-Type")};a.dataURL="data:"+a.type+";base64,"+X.encode64(i.responseBody||i.responseText),e({type:"load",result:a},i)}else e({type:"error"},i)},i.send(null)):e({type:"error"}),i},encode64:function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="",a=0;for("string"!=typeof t&&(t=String(t));a<t.length;){var n,r,o=255&t.charCodeAt(a++),s=255&t.charCodeAt(a++),c=255&t.charCodeAt(a++),h=o>>2,l=(3&o)<<4|s>>4;isNaN(s)?n=r=64:(n=(15&s)<<2|c>>6,r=isNaN(c)?64:63&c),i+=e.charAt(h)+e.charAt(l)+e.charAt(n)+e.charAt(r)}return i}};function q(t,e,i,a,n){var r={type:i.type||i,target:t,result:a};z(r,n),e(r)}function Y(t){return m&&!!m.prototype["readAs"+t]}function G(t,e,i,a){if(X.isBlob(t)&&Y(i)){var n=new m;H(n,j,(function i(a){var r=a.type;"progress"==r?q(t,e,a,a.target.result,{loaded:a.loaded,total:a.total}):"loadend"==r?(N(n,j,i),n=null):q(t,e,a,a.target.result)}));try{a?n["readAs"+i](t,a):n["readAs"+i](t)}catch(i){q(t,e,"error",void 0,{error:i.toString()})}}else q(t,e,"error",void 0,{error:"filreader_not_support_"+i})}function $(t){return t&&(t.isFile||t.isDirectory)}function K(t){var e;return t.getAsEntry?e=t.getAsEntry():t.webkitGetAsEntry&&(e=t.webkitGetAsEntry()),e}function Q(t){return T.test(t&&t.tagName)}function V(t){return(t.originalEvent||t||"").dataTransfer||{}}X.addInfoReader(/^image/,(function(t,e){if(!t.__dimensions){var i=t.__dimensions=X.defer();X.readAsImage(t,(function(t){var e=t.target;i.resolve("load"!=t.type&&"error",{width:e.width,height:e.height}),e.src=X.EMPTY_PNG,e=null}))}t.__dimensions.then(e)})),X.event.dnd=function(t,e,i){var a,n;i||(i=e,e=X.F),m?(H(t,"dragenter dragleave dragover",e.ff=e.ff||function(t){for(var i=V(t).types,r=i&&i.length,o=!1;r--;)if(~i[r].indexOf("File")){t.preventDefault(),n!==t.type&&("dragleave"!=(n=t.type)&&e.call(t.currentTarget,!0,t),o=!0);break}o&&(clearTimeout(a),a=setTimeout((function(){e.call(t.currentTarget,"dragleave"!=n,t)}),50))}),H(t,"drop",i.ff=i.ff||function(t){t.preventDefault(),n=0,X.getDropFiles(t,(function(e,a){i.call(t.currentTarget,e,a,t)})),e.call(t.currentTarget,!1,t)})):X.log("Drag'n'Drop -- not supported")},X.event.dnd.off=function(t,e,i){N(t,"dragenter dragleave dragover",e.ff),N(t,"drop",i.ff)},y&&!y.fn.dnd&&(y.fn.dnd=function(t,e){return this.each((function(){X.event.dnd(this,t,e)}))},y.fn.offdnd=function(t,e){return this.each((function(){X.event.dnd.off(this,t,e)}))}),t.FileAPI=z(X,t.FileAPI),X.log("FileAPI: "+X.version),X.log("protocol: "+t.location.protocol),X.log("doctype: ["+s.name+"] "+s.publicId+" "+s.systemId),P(o.getElementsByTagName("meta"),(function(t){/x-ua-compatible/i.test(t.getAttribute("http-equiv"))&&X.log("meta.http-equiv: "+t.getAttribute("content"))}));try{i=!!console.log,a=!!console.log.apply}catch(t){}X.flashUrl||(X.flashUrl=X.staticPath+"FileAPI.flash.swf"),X.flashImageUrl||(X.flashImageUrl=X.staticPath+"FileAPI.flash.image.swf"),X.flashWebcamUrl||(X.flashWebcamUrl=X.staticPath+"FileAPI.flash.camera.swf")}(window),function(t,e,i){"use strict";var a=Math.min,n=Math.round,r=function(){return e.createElement("canvas")},o=!1,s={8:270,3:180,6:90,7:270,4:180,5:90};try{o=r().toDataURL("image/png").indexOf("data:image/png")>-1}catch(t){}function c(e){if(e instanceof c){var i=new c(e.file);return t.extend(i.matrix,e.matrix),i}if(!(this instanceof c))return new c(e);this.file=e,this.size=e.size||100,this.matrix={sx:0,sy:0,sw:0,sh:0,dx:0,dy:0,dw:0,dh:0,resize:0,deg:0,quality:1,filter:0}}c.prototype={image:!0,constructor:c,set:function(e){return t.extend(this.matrix,e),this},crop:function(t,e,i,a){return void 0===i&&(i=t,a=e,t=e=0),this.set({sx:t,sy:e,sw:i,sh:a||i})},resize:function(t,e,i){return/min|max|height|width/.test(e)&&(i=e,e=t),this.set({dw:t,dh:e||t,resize:i})},preview:function(t,e){return this.resize(t,e||t,"preview")},rotate:function(t){return this.set({deg:t})},filter:function(t){return this.set({filter:t})},overlay:function(t){return this.set({overlay:t})},clone:function(){return new c(this)},_load:function(e,i){var a=this;/img|video/i.test(e.nodeName)?i.call(a,null,e):t.readAsImage(e,(function(t){i.call(a,"load"!=t.type,t.result)}))},_apply:function(e,i){var n,o=r(),s=this.getMatrix(e),h=o.getContext("2d"),l=e.videoWidth||e.width,u=e.videoHeight||e.height,d=s.deg,p=s.dw,f=s.dh,m=l,g=u,v=s.filter,y=e,w=s.overlay,b=t.queue((function(){e.src=t.EMPTY_PNG,i(!1,o)})),x=t.renderImageToCanvas;for(d-=360*Math.floor(d/360),e._type=this.file.type;s.multipass&&a(m/p,g/f)>2;)m=m/2+.5|0,g=g/2+.5|0,(n=r()).width=m,n.height=g,y!==e?(x(n,y,0,0,y.width,y.height,0,0,m,g),y=n):(x(y=n,e,s.sx,s.sy,s.sw,s.sh,0,0,m,g),s.sx=s.sy=s.sw=s.sh=0);o.width=d%180?f:p,o.height=d%180?p:f,o.type=s.type,o.quality=s.quality,h.rotate(d*Math.PI/180),x(h.canvas,y,s.sx,s.sy,s.sw||y.width,s.sh||y.height,180==d||270==d?-p:0,90==d||180==d?-f:0,p,f),h.setTransform(1,0,0,1,0,0),p=o.width,f=o.height,w&&t.each([].concat(w),(function(e){b.inc();var i=new window.Image,a=function(){var n=0|e.x,r=0|e.y,o=e.w||i.width,s=e.h||i.height,c=e.rel;n=1==c||4==c||7==c?(p-o+n)/2:2==c||5==c||8==c?p-(o+n):n,r=3==c||4==c||5==c?(f-s+r)/2:c>=6?f-(s+r):r,t.event.off(i,"error load abort",a);try{h.globalAlpha=e.opacity||1,h.drawImage(i,n,r,o,s)}catch(t){}b.next()};t.event.on(i,"error load abort",a),i.src=e.src,i.complete&&a()})),v&&(b.inc(),c.applyFilter(o,v,b.next)),b.check()},getMatrix:function(e){var i,r,o=t.extend({},this.matrix),s=o.sw=o.sw||e.videoWidth||e.naturalWidth||e.width,c=o.sh=o.sh||e.videoHeight||e.naturalHeight||e.height,h=o.dw=o.dw||s,l=o.dh=o.dh||c,u=s/c,d=h/l,p=o.resize;"preview"==p?h==s&&l==c||(d>=u?r=(i=s)/d:i=(r=c)*d,i==s&&r==c||(o.sx=~~((s-i)/2),o.sy=~~((c-r)/2),s=i,c=r)):"height"==p?h=l*u:"width"==p?l=h/u:p&&(s>h||c>l?"min"==p?(h=n(u<d?a(s,h):l*u),l=n(u<d?h/u:a(c,l))):(h=n(u>=d?a(s,h):l*u),l=n(u>=d?h/u:a(c,l))):(h=s,l=c));return o.sw=s,o.sh=c,o.dw=h,o.dh=l,o.multipass=t.multiPassResize,o},_trans:function(e){this._load(this.file,(function(i,a){if(i)e(i);else try{this._apply(a,e)}catch(i){t.log("[err] FileAPI.Image.fn._apply:",i),e(i)}}))},get:function(e){if(t.support.transform){var i=this,a=i.matrix;"auto"==a.deg?t.getInfo(i.file,(function(t,n){a.deg=s[n&&n.exif&&n.exif.Orientation]||0,i._trans(e)})):i._trans(e)}else e("not_support_transform");return this},toData:function(t){return this.get(t)}},c.exifOrientation=s,c.transform=function(e,i,a,n){function r(r,o){var s={},h=t.queue((function(t){n(t,s)}));r?h.fail():t.each(i,(function(t,i){if(!h.isFail()){var n=new c(o.nodeType?o:e),r="function"==typeof t;if(r?t(o,n):t.width?n[t.preview?"preview":"resize"](t.width,t.height,t.strategy):t.maxWidth&&(o.width>t.maxWidth||o.height>t.maxHeight)&&n.resize(t.maxWidth,t.maxHeight,"max"),t.crop){var l=t.crop;n.crop(0|l.x,0|l.y,l.w||l.width,l.h||l.height)}void 0===t.rotate&&a&&(t.rotate="auto"),n.set({type:n.matrix.type||t.type||e.type||"image/png"}),r||n.set({deg:t.rotate,overlay:t.overlay,filter:t.filter,quality:t.quality||1}),h.inc(),n.toData((function(t,e){t?h.fail():(s[i]=e,h.next())}))}}))}e.width?r(!1,e):t.getInfo(e,r)},t.each(["TOP","CENTER","BOTTOM"],(function(e,i){t.each(["LEFT","CENTER","RIGHT"],(function(t,a){c[e+"_"+t]=3*i+a,c[t+"_"+e]=3*i+a}))})),c.toCanvas=function(t){var i=e.createElement("canvas");return i.width=t.videoWidth||t.width,i.height=t.videoHeight||t.height,i.getContext("2d").drawImage(t,0,0),i},c.fromDataURL=function(e,i,a){var n=t.newImage(e);t.extend(n,i),a(n)},c.applyFilter=function(e,i,a){"function"==typeof i?i(e,a):window.Caman&&window.Caman("IMG"==e.tagName?c.toCanvas(e):e,(function(){"string"==typeof i?this[i]():t.each(i,(function(t,e){this[e](t)}),this),this.render(a)}))},t.renderImageToCanvas=function(e,i,a,n,r,o,s,c,h,l){try{return e.getContext("2d").drawImage(i,a,n,r,o,s,c,h,l)}catch(e){throw t.log("renderImageToCanvas failed"),e}},t.support.canvas=t.support.transform=o,t.Image=c}(FileAPI,document),function(t){"use strict";!function(t){if(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))return;var e=t.renderImageToCanvas;t.detectSubsampling=function(t){var e,i;return t.width*t.height>1048576&&((e=document.createElement("canvas")).width=e.height=1,(i=e.getContext("2d")).drawImage(t,1-t.width,0),0===i.getImageData(0,0,1,1).data[3])},t.detectVerticalSquash=function(t,e){var i,a,n,r,o=t.naturalHeight||t.height,s=document.createElement("canvas"),c=s.getContext("2d");for(e&&(o/=2),s.width=1,s.height=o,c.drawImage(t,0,0),i=c.getImageData(0,0,1,o).data,a=0,n=o,r=o;r>a;)0===i[4*(r-1)+3]?n=r:a=r,r=n+a>>1;return r/o||1},t.renderImageToCanvas=function(i,a,n,r,o,s,c,h,l,u){if("image/jpeg"===a._type){var d,p,f,m,g=i.getContext("2d"),v=document.createElement("canvas"),y=v.getContext("2d");if(v.width=1024,v.height=1024,g.save(),(d=t.detectSubsampling(a))&&(n/=2,r/=2,o/=2,s/=2),p=t.detectVerticalSquash(a,d),d||1!==p){for(r*=p,l=Math.ceil(1024*l/o),u=Math.ceil(1024*u/s/p),h=0,m=0;m<s;){for(c=0,f=0;f<o;)y.clearRect(0,0,1024,1024),y.drawImage(a,n,r,o,s,-f,-m,o,s),g.drawImage(v,0,0,1024,1024,c,h,l,u),f+=1024,c+=l;m+=1024,h+=u}return g.restore(),i}}return e(i,a,n,r,o,s,c,h,l,u)}}(FileAPI)}(),function(t,e){"use strict";var i=e.document,a=e.FormData,n=function(){this.items=[]},r=e.encodeURIComponent;function o(e,i,a){var n=e.blob,r=e.file;if(r){if(!n.toDataURL)return void t.readAsBinaryString(n,(function(t){"load"==t.type&&i(e,t.result)}));var o={"image/jpeg":".jpe?g","image/png":".png"},s=o[e.type]?e.type:"image/png",c=o[s]||".png",h=n.quality||1;r.match(new RegExp(c+"$","i"))||(r+=c.replace("?","")),e.file=r,e.type=s,!a&&n.toBlob?n.toBlob((function(t){i(e,t)}),s,h):i(e,t.toBinaryString(n.toDataURL(s,h)))}else i(e,n)}n.prototype={append:function(t,e,i,a){this.items.push({name:t,blob:e&&e.blob||(null==e?"":e),file:e&&(i||e.name),type:e&&(a||e.type)})},each:function(t){for(var e=0,i=this.items.length;e<i;e++)t.call(this,this.items[e])},toData:function(e,i){i._chunked=t.support.chunked&&i.chunkSize>0&&1==t.filter(this.items,(function(t){return t.file})).length,t.support.html5?t.formData&&!this.multipart&&a?i._chunked?(t.log("FileAPI.Form.toPlainData"),this.toPlainData(e)):(t.log("FileAPI.Form.toFormData"),this.toFormData(e)):(t.log("FileAPI.Form.toMultipartData"),this.toMultipartData(e)):(t.log("FileAPI.Form.toHtmlData"),this.toHtmlData(e))},_to:function(e,i,a,n){var r=t.queue((function(){i(e)}));this.each((function(o){try{a(o,e,r,n)}catch(e){t.log("FileAPI.Form._to: "+e.message),i(e)}})),r.check()},toHtmlData:function(e){this._to(i.createDocumentFragment(),e,(function(e,a){var n,r=e.blob;e.file?(t.reset(r,!0),r.name=e.name,r.disabled=!1,a.appendChild(r)):((n=i.createElement("input")).name=e.name,n.type="hidden",n.value=r,a.appendChild(n))}))},toPlainData:function(t){this._to({},t,(function(t,e,i){t.file&&(e.type=t.file),t.blob.toBlob?(i.inc(),o(t,(function(t,a){e.name=t.name,e.file=a,e.size=a.length,e.type=t.type,i.next()}))):t.file?(e.name=t.blob.name,e.file=t.blob,e.size=t.blob.size,e.type=t.type):(e.params||(e.params=[]),e.params.push(r(t.name)+"="+r(t.blob))),e.start=-1,e.end=e.file&&e.file.FileAPIReadPosition||-1,e.retry=0}))},toFormData:function(t){this._to(new a,t,(function(t,e,i){t.blob&&t.blob.toBlob?(i.inc(),o(t,(function(t,a){e.append(t.name,a,t.file),i.next()}))):t.file?e.append(t.name,t.blob,t.file):e.append(t.name,t.blob),t.file&&e.append("_"+t.name,t.file)}))},toMultipartData:function(e){this._to([],e,(function(t,e,i,a){i.inc(),o(t,(function(t,n){e.push("--_"+a+'\r\nContent-Disposition: form-data; name="'+t.name+'"'+(t.file?'; filename="'+r(t.file)+'"':"")+(t.file?"\r\nContent-Type: "+(t.type||"application/octet-stream"):"")+"\r\n\r\n"+(t.file?n:r(n))+"\r\n"),i.next()}),!0)}),t.expando)}},t.Form=n}(FileAPI,window),function(t,e){"use strict";var i=function(){},a=t.document,n=function(t){this.uid=e.uid(),this.xhr={abort:i,getResponseHeader:i,getAllResponseHeaders:i},this.options=t},r={"":1,XML:1,Text:1,Body:1};n.prototype={status:0,statusText:"",constructor:n,getResponseHeader:function(t){return this.xhr.getResponseHeader(t)},getAllResponseHeaders:function(){return this.xhr.getAllResponseHeaders()||{}},end:function(a,n){var r=this,o=r.options;r.end=r.abort=i,r.status=a,n&&(r.statusText=n),e.log("xhr.end:",a,n),o.complete(200!=a&&201!=a&&(r.statusText||"unknown"),r),r.xhr&&r.xhr.node&&setTimeout((function(){var e=r.xhr.node;try{e.parentNode.removeChild(e)}catch(t){}try{delete t[r.uid]}catch(t){}t[r.uid]=r.xhr.node=null}),9)},abort:function(){this.end(0,"abort"),this.xhr&&(this.xhr.aborted=!0,this.xhr.abort())},send:function(t){var e=this,i=this.options;t.toData((function(t){t instanceof Error?e.end(0,t.message):(i.upload(i,e),e._send.call(e,i,t))}),i)},_send:function(i,n){var o,s=this,c=s.uid,h=s.uid+"Load",l=i.url;if(e.log("XHR._send:",n),i.cache||(l+=(~l.indexOf("?")?"&":"?")+e.uid()),n.nodeName){var u=i.jsonp;l=l.replace(/([a-z]+)=(\?)/i,"$1="+c),i.upload(i,s);var d=function(t){if(~l.indexOf(t.origin))try{var i=e.parseJSON(t.data);i.id==c&&p(i.status,i.statusText,i.response)}catch(t){p(0,t.message)}},p=t[c]=function(i,a,n){s.readyState=4,s.responseText=n,s.end(i,a),e.event.off(t,"message",d),t[c]=o=m=t[h]=null};s.xhr.abort=function(){try{m.stop?m.stop():m.contentWindow.stop?m.contentWindow.stop():m.contentWindow.document.execCommand("Stop")}catch(t){}p(0,"abort")},e.event.on(t,"message",d),t[h]=function(){try{var t=m.contentWindow,i=t.document,a=t.result||e.parseJSON(i.body.innerHTML);p(a.status,a.statusText,a.response)}catch(t){e.log("[transport.onload]",t)}},(o=a.createElement("div")).innerHTML='<form target="'+c+'" action="'+l+'" method="POST" enctype="multipart/form-data" style="position: absolute; top: -1000px; overflow: hidden; width: 1px; height: 1px;"><iframe name="'+c+'" src="javascript:false;" onload="window.'+h+" && "+h+'();"></iframe>'+(u&&i.url.indexOf("=?")<0?'<input value="'+c+'" name="'+u+'" type="hidden"/>':"")+"</form>";var f=o.getElementsByTagName("form")[0],m=o.getElementsByTagName("iframe")[0];f.appendChild(n),e.log(f.parentNode.innerHTML),a.body.appendChild(o),s.xhr.node=o,s.readyState=2;try{f.submit()}catch(t){e.log("iframe.error: "+t)}f=null}else{if(l=l.replace(/([a-z]+)=(\?)&?/i,""),this.xhr&&this.xhr.aborted)return void e.log("Error: already aborted");if(o=s.xhr=e.getXHR(),n.params&&(l+=(l.indexOf("?")<0?"?":"&")+n.params.join("&")),o.open(i.uploadMethod||"POST",l,!0),"boolean"==typeof i.uploadCredentials?o.withCredentials=i.uploadCredentials?"true":null:e.withCredentials&&(o.withCredentials="true"),i.headers&&i.headers["X-Requested-With"]||o.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.each(i.headers,(function(t,e){o.setRequestHeader(e,t)})),i._chunked){o.upload&&o.upload.addEventListener("progress",e.throttle((function(t){n.retry||i.progress({type:t.type,total:n.size,loaded:n.start+t.loaded,totalSize:n.size},s,i)}),100),!1),o.onreadystatechange=function(){var t=parseInt(o.getResponseHeader("X-Last-Known-Byte"),10);if(s.status=o.status,s.statusText=o.statusText,s.readyState=o.readyState,4==o.readyState){for(var a in r)s["response"+a]=o["response"+a];if(o.onreadystatechange=null,!o.status||o.status-201>0)if(e.log("Error: "+o.status),(!o.status&&!o.aborted||500==o.status||416==o.status)&&++n.retry<=i.chunkUploadRetry){var c=o.status?0:e.chunkNetworkDownRetryTimeout;i.pause(n.file,i),e.log("X-Last-Known-Byte: "+t),t?n.end=t:(n.end=n.start-1,416==o.status&&(n.end=n.end-i.chunkSize)),setTimeout((function(){s._send(i,n)}),c)}else s.end(o.status);else n.retry=0,n.end==n.size-1?s.end(o.status):(e.log("X-Last-Known-Byte: "+t),t&&(n.end=t),n.file.FileAPIReadPosition=n.end,setTimeout((function(){s._send(i,n)}),0));o=null}},n.start=n.end+1,n.end=Math.max(Math.min(n.start+i.chunkSize,n.size)-1,n.start);var g=n.file,v=(g.slice||g.mozSlice||g.webkitSlice).call(g,n.start,n.end+1);n.size&&!v.size?setTimeout((function(){s.end(-1)})):(o.setRequestHeader("Content-Range","bytes "+n.start+"-"+n.end+"/"+n.size),o.setRequestHeader("Content-Disposition","attachment; filename="+encodeURIComponent(n.name)),o.setRequestHeader("Content-Type",n.type||"application/octet-stream"),o.send(v)),g=v=null}else if(o.upload&&o.upload.addEventListener("progress",e.throttle((function(t){i.progress(t,s,i)}),100),!1),o.onreadystatechange=function(){if(s.status=o.status,s.statusText=o.statusText,s.readyState=o.readyState,4==o.readyState){for(var t in r)s["response"+t]=o["response"+t];if(o.onreadystatechange=null,!o.status||o.status>201)if(e.log("Error: "+o.status),(!o.status&&!o.aborted||500==o.status)&&(i.retry||0)<i.uploadRetry){i.retry=(i.retry||0)+1;var a=e.networkDownRetryTimeout;i.pause(i.file,i),setTimeout((function(){s._send(i,n)}),a)}else s.end(o.status);else s.end(o.status);o=null}},e.isArray(n)){o.setRequestHeader("Content-Type","multipart/form-data; boundary=_"+e.expando);var y=n.join("")+"--_"+e.expando+"--";if(o.sendAsBinary)o.sendAsBinary(y);else{var w=Array.prototype.map.call(y,(function(t){return 255&t.charCodeAt(0)}));o.send(new Uint8Array(w).buffer)}}else o.send(n)}}},e.XHR=n}(window,FileAPI),function(t,e){"use strict";var i=t.URL||t.webkitURL,a=t.document,n=t.navigator,r=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia,o=!!r;e.support.media=o;var s,c,h,l,u=function(t){this.video=t};u.prototype={isActive:function(){return!!this._active},start:function(t){var o,s,c=this,h=c.video,l=function(e){c._active=!e,clearTimeout(s),clearTimeout(o),t&&t(e,c)};r.call(n,{video:!0},(function(t){c.stream=t;try{h.src=i.createObjectURL(t)}catch(e){h.srcObject=t}o=setInterval((function(){(function(t){var i,n=a.createElement("canvas"),r=!1;try{(i=n.getContext("2d")).drawImage(t,0,0,1,1),r=255!=i.getImageData(0,0,1,1).data[4]}catch(t){e.log("[FileAPI.Camera] detectVideoSignal:",t)}return r})(h)&&l(null)}),1e3),s=setTimeout((function(){l("timeout")}),5e3),h.play()}),l)},stop:function(){try{this._active=!1,this.video.pause();try{this.stream.stop()}catch(t){e.each(this.stream.getTracks(),(function(t){t.stop()}))}this.stream=null}catch(t){e.log("[FileAPI.Camera] stop:",t)}},shot:function(){return new d(this.video)}},u.get=function(t){return new u(t.firstChild)},u.publish=function(i,n,r){"function"==typeof n&&(r=n,n={}),n=e.extend({},{width:"100%",height:"100%",start:!0},n),i.jquery&&(i=i[0]);var s=function(t){if(t)r(t);else{var e=u.get(i);n.start?e.start(r):r(null,e)}};if(i.style.width=p(n.width),i.style.height=p(n.height),e.html5&&o&&!e.insecureChrome){var c=a.createElement("video");c.style.width=p(n.width),c.style.height=p(n.height),t.jQuery?jQuery(i).empty():i.innerHTML="",i.appendChild(c),s()}else u.fallback(i,n,s)},u.fallback=function(t,e,i){i("not_support_camera")},u.checkAlreadyCaptured=(c=n.mediaDevices,h=t.MediaStreamTrack,l=n.enumerateDevices,s=c&&c.enumerateDevices?function(t){c.enumerateDevices().then(t)}:h&&h.getSources?h.getSources.bind(h):l?l.bind(n):function(t){t([])},function(t){s((function(e){var i=e.some((function(t){return("videoinput"===t.kind||"video"===t.kind)&&t.label}));t(i)}))});var d=function(t){var i=t.nodeName?e.Image.toCanvas(t):t,a=e.Image(i);return a.type="image/png",a.width=i.width,a.height=i.height,a.size=i.width*i.height*4,a};function p(t){return t>=0?t+"px":t}u.Shot=d,e.Camera=u}(window,FileAPI),function(t,e,i){"use strict";var a=t.document,n=t.location,r=t.navigator,o=i.each;i.support.flash=function(){var e=r.mimeTypes,a=!1;if(r.plugins&&"object"==typeof r.plugins["Shockwave Flash"])a=r.plugins["Shockwave Flash"].description&&!(e&&e["application/x-shockwave-flash"]&&!e["application/x-shockwave-flash"].enabledPlugin);else try{a=!(!t.ActiveXObject||!new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(t){i.log("Flash -- does not supported.")}return a&&/^file:/i.test(n)&&i.log("[warn] Flash does not work on `file:` protocol."),a}(),i.support.flash&&(!i.html5||!i.support.html5||i.cors&&!i.support.cors||i.media&&!i.support.media||i.insecureChrome)&&function(){var s=i.uid(),c=0,h={},l=/^https?:/i,u={_fn:{},init:function(){var t=a.body&&a.body.firstChild;if(t)do{if(1==t.nodeType){i.log("FlashAPI.state: awaiting");var e=a.createElement("div");return e.id="_"+s,p(e,{top:1,right:1,width:5,height:5,position:"absolute",zIndex:"2147483647"}),t.parentNode.insertBefore(e,t),void u.publish(e,s)}}while(t=t.nextSibling);c<10&&setTimeout(u.init,50*++c)},publish:function(t,e,a){a=a||{},t.innerHTML=d({id:e,src:y(i.flashUrl,"r="+i.version),wmode:a.camera?"":"transparent",flashvars:"callback="+(a.onEvent||"FileAPI.Flash.onEvent")+"&flashId="+e+"&storeKey="+r.userAgent.match(/\d/gi).join("")+"_"+i.version+(u.isReady||(i.pingUrl?"&ping="+i.pingUrl:""))+"&timeout="+i.flashAbortTimeout+(a.camera?"&useCamera="+y(i.flashWebcamUrl):"")+"&debug="+(i.debug?"1":"")})},ready:function(){i.log("FlashAPI.state: ready"),u.ready=i.F,u.isReady=!0,u.patch(),u.patchCamera&&u.patchCamera(),i.event.on(a,"mouseover",u.mouseover),i.event.on(a,"click",(function(t){u.mouseover(t)&&(t.preventDefault?t.preventDefault():t.returnValue=!0)}))},getEl:function(){return a.getElementById("_"+s)},getWrapper:function(t){do{if(/js-fileapi-wrapper/.test(t.className))return t}while((t=t.parentNode)&&t!==a.body)},mouseover:function(e){var n=i.event.fix(e).target;if(/input/i.test(n.nodeName)&&"file"==n.type&&!n.disabled){var r=n.getAttribute(s),o=u.getWrapper(n);if(i.multiFlash){if("i"==r||"r"==r)return!1;if("p"!=r){n.setAttribute(s,"i");var c=a.createElement("div");if(!o)return void i.log("[err] FlashAPI.mouseover: js-fileapi-wrapper not found");p(c,{top:0,left:0,width:n.offsetWidth,height:n.offsetHeight,zIndex:"2147483647",position:"absolute"}),o.appendChild(c),u.publish(c,i.uid()),n.setAttribute(s,"p")}return!0}if(o){var h=function(e){var i=e.getBoundingClientRect(),n=a.body,r=(e&&e.ownerDocument).documentElement;return{top:i.top+(t.pageYOffset||r.scrollTop)-(r.clientTop||n.clientTop||0),left:i.left+(t.pageXOffset||r.scrollLeft)-(r.clientLeft||n.clientLeft||0),width:i.right-i.left,height:i.bottom-i.top}}(o);p(u.getEl(),h),u.curInp=n}}else/object|embed/i.test(n.nodeName)||p(u.getEl(),{top:1,left:1,width:5,height:5})},onEvent:function(t){var e=t.type;if("ready"==e){try{u.getInput(t.flashId).setAttribute(s,"r")}catch(t){}return u.ready(),setTimeout((function(){u.mouseenter(t)}),50),!0}"ping"===e?i.log("(flash -> js).ping:",[t.status,t.savedStatus],t.error):"log"===e?i.log("(flash -> js).log:",t.target):e in u&&setTimeout((function(){i.log("FlashAPI.event."+t.type+":",t),u[e](t)}),1)},mouseenter:function(t){var e=u.getInput(t.flashId);if(e){u.cmd(t,"multiple",null!=e.getAttribute("multiple"));var a=[],n={};o((e.getAttribute("accept")||"").split(/,\s*/),(function(t){i.accept[t]&&o(i.accept[t].split(" "),(function(t){n[t]=1}))})),o(n,(function(t,e){a.push(e)})),u.cmd(t,"accept",a.length?a.join(",")+","+a.join(",").toUpperCase():"*")}},get:function(e){return a[e]||t[e]||a.embeds[e]},getInput:function(t){if(!i.multiFlash)return u.curInp;try{var e=u.getWrapper(u.get(t));if(e)return e.getElementsByTagName("input")[0]}catch(e){i.log('[err] Can not find "input" by flashId:',t,e)}},select:function(t){var n,r=u.getInput(t.flashId),s=i.uid(r),c=t.target.files;o(c,(function(t){i.checkFileObj(t)})),h[s]=c,a.createEvent?((n=a.createEvent("Event")).files=c,n.initEvent("change",!0,!0),r.dispatchEvent(n)):e?e(r).trigger({type:"change",files:c}):((n=a.createEventObject()).files=c,r.fireEvent("onchange",n))},cmd:function(t,e,a,n){try{return i.log("(js -> flash)."+e+":",a),u.get(t.flashId||t).cmd(e,a)}catch(r){i.log("(js -> flash).onError:",r.toString()),n||setTimeout((function(){u.cmd(t,e,a,!0)}),50)}},patch:function(){i.flashEngine=!0,f(i,{getFiles:function(t,e,a){if(a)return i.filterFiles(i.getFiles(t),e,a),null;var n=i.isArray(t)?t:h[i.uid(t.target||t.srcElement||t)];return n?(e&&(e=i.getFilesFilter(e),n=i.filter(n,(function(t){return e.test(t.name)}))),n):this.parent.apply(this,arguments)},getInfo:function(t,e){if(m(t))this.parent.apply(this,arguments);else if(t.isShot)e(null,t.info={width:t.width,height:t.height});else{if(!t.__info){var a=t.__info=i.defer();u.cmd(t,"getFileInfo",{id:t.id,callback:g((function e(i,n){v(e),a.resolve(i,t.info=n)}))})}t.__info.then(e)}}}),i.support.transform=!0,i.Image&&f(i.Image.prototype,{get:function(t,e){return this.set({scaleMode:e||"noScale"}),this.parent(t)},_load:function(t,e){if(i.log("FlashAPI.Image._load:",t),m(t))this.parent.apply(this,arguments);else{var a=this;i.getInfo(t,(function(i){e.call(a,i,t)}))}},_apply:function(t,e){if(i.log("FlashAPI.Image._apply:",t),m(t))this.parent.apply(this,arguments);else{var a=this.getMatrix(t.info),n=e;u.cmd(t,"imageTransform",{id:t.id,matrix:a,callback:g((function r(o,s){i.log("FlashAPI.Image._apply.callback:",o),v(r),o?n(o):i.support.html5||i.support.dataURI&&!(s.length>3e4)?(a.filter&&(n=function(t,n){t?e(t):i.Image.applyFilter(n,a.filter,(function(){e(t,this.canvas)}))}),i.newImage("data:"+t.type+";base64,"+s,n)):w({width:a.deg%180?a.dh:a.dw,height:a.deg%180?a.dw:a.dh,scale:a.scaleMode},s,n)}))})}},toData:function(t){var e=this.file,a=e.info,n=this.getMatrix(a);i.log("FlashAPI.Image.toData"),m(e)?this.parent.apply(this,arguments):("auto"==n.deg&&(n.deg=i.Image.exifOrientation[a&&a.exif&&a.exif.Orientation]||0),t.call(this,!e.info,{id:e.id,flashId:e.flashId,name:e.name,type:e.type,matrix:n}))}}),i.Image&&f(i.Image,{fromDataURL:function(t,e,a){!i.support.dataURI||t.length>3e4?w(i.extend({scale:"exactFit"},e),t.replace(/^data:[^,]+,/,""),(function(t,e){a(e)})):this.parent(t,e,a)}}),f(i.Form.prototype,{toData:function(t){for(var e=this.items,a=e.length;a--;)if(e[a].file&&m(e[a].blob))return this.parent.apply(this,arguments);i.log("FlashAPI.Form.toData"),t(e)}}),f(i.XHR.prototype,{_send:function(t,e){if(e.nodeName||e.append&&i.support.html5||i.isArray(e)&&"string"==typeof e[0])return this.parent.apply(this,arguments);var a,n,r={},c={},h=this;if(o(e,(function(t){t.file?(c[t.name]=t=b(t.blob),n=t.id,a=t.flashId):r[t.name]=t.blob})),n||(a=s),!a)return i.log("[err] FlashAPI._send: flashId -- undefined"),this.parent.apply(this,arguments);i.log("FlashAPI.XHR._send: "+a+" -> "+n),h.xhr={headers:{},abort:function(){u.cmd(a,"abort",{id:n})},getResponseHeader:function(t){return this.headers[t]},getAllResponseHeaders:function(){return this.headers}};var l=i.queue((function(){u.cmd(a,"upload",{url:y(t.url.replace(/([a-z]+)=(\?)&?/i,"")),data:r,files:n?c:null,headers:t.headers||{},callback:g((function e(a){var n=a.type,r=a.result;i.log("FlashAPI.upload."+n),"progress"==n?(a.loaded=Math.min(a.loaded,a.total),a.lengthComputable=!0,t.progress(a)):"complete"==n?(v(e),"string"==typeof r&&(h.responseText=r.replace(/%22/g,'"').replace(/%5c/g,"\\").replace(/%26/g,"&").replace(/%25/g,"%")),h.end(a.status||200)):"abort"!=n&&"error"!=n||(h.end(a.status||0,a.message),v(e))}))})}));o(c,(function(t){l.inc(),i.getInfo(t,l.next)})),l.check()}})}};function d(t){return('<object id="#id#" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+(t.width||"100%")+'" height="'+(t.height||"100%")+'"><param name="movie" value="#src#" /><param name="flashvars" value="#flashvars#" /><param name="swliveconnect" value="true" /><param name="allowscriptaccess" value="always" /><param name="allownetworking" value="all" /><param name="menu" value="false" /><param name="wmode" value="#wmode#" /><embed flashvars="#flashvars#" swliveconnect="true" allownetworking="all" allowscriptaccess="always" name="#id#" src="#src#" width="'+(t.width||"100%")+'" height="'+(t.height||"100%")+'" menu="false" wmode="transparent" type="application/x-shockwave-flash"></embed></object>').replace(/#(\w+)#/gi,(function(e,i){return t[i]}))}function p(t,e){var i,a;if(t&&t.style)for(i in e){"number"==typeof(a=e[i])&&(a+="px");try{t.style[i]=a}catch(t){}}}function f(t,e){o(e,(function(e,i){var a=t[i];t[i]=function(){return this.parent=a,e.apply(this,arguments)}}))}function m(t){return t&&!t.flashId}function g(t){var e=t.wid=i.uid();return u._fn[e]=t,"FileAPI.Flash._fn."+e}function v(t){try{u._fn[t.wid]=null,delete u._fn[t.wid]}catch(t){}}function y(t,e){if(!l.test(t)){if(/^\.\//.test(t)||"/"!=t.charAt(0)){var i=n.pathname;t=((i=i.substr(0,i.lastIndexOf("/")))+"/"+t).replace("/./","/")}"//"!=t.substr(0,2)&&(t="//"+n.host+t),l.test(t)||(t=n.protocol+t)}return e&&(t+=(/\?/.test(t)?"&":"?")+e),t}function w(t,e,n){var r,o=i.uid(),s=a.createElement("div"),c=10;for(r in t)s.setAttribute(r,t[r]),s[r]=t[r];p(s,t),t.width="100%",t.height="100%",s.innerHTML=d(i.extend({id:o,src:y(i.flashImageUrl,"r="+i.uid()),wmode:"opaque",flashvars:"scale="+t.scale+"&callback="+g((function t(){return v(t),--c>0&&function(){try{u.get(o).setImage(e)}catch(t){i.log('[err] FlashAPI.Preview.setImage -- can not set "base64":',t)}}(),!0}))},t)),n(!1,s),s=null}function b(t){return{id:t.id,name:t.name,matrix:t.matrix,flashId:t.flashId}}i.Flash=u,i.newImage("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",(function(t,e){i.support.dataURI=!(1!=e.width||1!=e.height),u.init()}))}()}(window,window.jQuery,FileAPI),function(t,e,i){"use strict";var a=i.each,n=[];!i.support.flash||!i.media||i.support.media&&i.html5&&!i.insecureChrome||function(){function t(t){var e=t.wid=i.uid();return i.Flash._fn[e]=t,"FileAPI.Flash._fn."+e}function e(t){try{i.Flash._fn[t.wid]=null,delete i.Flash._fn[t.wid]}catch(t){}}var r=i.Flash;i.extend(i.Flash,{patchCamera:function(){i.Camera.fallback=function(a,n,o){var s=i.uid();i.log("FlashAPI.Camera.publish: "+s),r.publish(a,s,i.extend(n,{camera:!0,onEvent:t((function t(a){"camera"===a.type&&(e(t),a.error?(i.log("FlashAPI.Camera.publish.error: "+a.error),o(a.error)):(i.log("FlashAPI.Camera.publish.success: "+s),o(null)))}))}))},a(n,(function(t){i.Camera.fallback.apply(i.Camera,t)})),n=[],i.extend(i.Camera.prototype,{_id:function(){return this.video.id},start:function(a){var n=this;r.cmd(this._id(),"camera.on",{callback:t((function t(r){e(t),r.error?(i.log("FlashAPI.camera.on.error: "+r.error),a(r.error,n)):(i.log("FlashAPI.camera.on.success: "+n._id()),n._active=!0,a(null,n))}))})},stop:function(){this._active=!1,r.cmd(this._id(),"camera.off")},shot:function(){i.log("FlashAPI.Camera.shot:",this._id());var t=i.Flash.cmd(this._id(),"shot",{});return t.type="image/png",t.flashId=this._id(),t.isShot=!0,new i.Camera.Shot(t)}})}}),i.Camera.fallback=function(){n.push(arguments)}}()}(window,window.jQuery,FileAPI),void 0===(a=function(){return FileAPI}.apply(e,[]))||(t.exports=a)},"8fjE":function(t,e,i){"use strict";i.r(e),i.d(e,"launch",(function(){return L}));var a=i("rVmq"),n=i.n(a),r=i("odIl"),o=i.n(r),s=i("Dl6t"),c=i.n(s),h=i("oQkc"),l=i.n(h),u=i("w4m/"),d=i.n(u),p=i("8g+w"),f=i.n(p),m=i("hqFE"),g=i.n(m),v=i("K1iI"),y=i.n(v),w=i("khZo"),b=i("lGT8"),x=i.n(b),A=i("DeC2"),C=i.n(A),D=i("aGAf"),I=i("244q"),M=i.n(I),T=i("DYG5");function F(t,e){var i=n()(t);if(o.a){var a=o()(t);e&&(a=c()(a).call(a,(function(e){return l()(t,e).enumerable}))),i.push.apply(i,a)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i,a=null!=arguments[e]?arguments[e]:{};if(e%2)d()(i=F(Object(a),!0)).call(i,(function(e){Object(w.a)(t,e,a[e])}));else if(f.a)g()(t,f()(a));else{var n;d()(n=F(Object(a))).call(n,(function(e){y()(t,e,l()(a,e))}))}}return t}var E=250,B=350,O=3,R=["image/jpeg","image/png"];var j=Object(T.a)((function(){var t=$('input[name="confirmation-email"]').val();if(t.length>0){var e=x()({},window.emailVerificationData);$.ajax({type:"POST",url:"/api/admission/confirmation/verify-email",data:k(k({},e),{},{email:t}),dataType:"json"}).done((function(t){Object(D.a)("Код был отправлен на указанный email.","info")})).fail((function(t,e,i){Object(D.a)("Email не был отправлен.","error")}))}}),1e3,{leading:!0,trailing:!1});function L(){Promise.all([i.e(1),i.e(3)]).then(i.bind(null,"0/dF")).then((function(t){t.initDatePickers()})).catch((function(t){return Object(D.g)(t)}));var t=document.querySelector("input[name=confirmation-photo]");M.a.event.on(t,"change",(function(e){t.closest(".form-group").classList.remove("has-error");var i=M.a.getFiles(e);M.a.filterFiles(i,(function(t,e){if(/^image/.test(t.type)){var i,a=C()(i=R).call(i,t.type),n=e.width>=E&&e.height>=B,r=t.size<O*M.a.MB;return a&&n&&r}return!1}),(function(e,i){0===e.length&&i.length>0&&t.closest(".form-group").classList.add("has-error")}))})),$("#confirm-email").click(j)}},Ctz4:function(t,e,i){
/*!
 * Cropper.js v1.5.9
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2020-09-10T13:16:26.743Z
 */
t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function r(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var c="undefined"!=typeof window&&void 0!==window.document,h=c?window:{},l=!(!c||!h.document.documentElement)&&"ontouchstart"in h.document.documentElement,u=!!c&&"PointerEvent"in h,d="".concat("cropper","-crop"),p="".concat("cropper","-disabled"),f="".concat("cropper","-hidden"),m="".concat("cropper","-hide"),g="".concat("cropper","-invisible"),v="".concat("cropper","-modal"),y="".concat("cropper","-move"),w="".concat("cropper","Action"),b="".concat("cropper","Preview"),x=l?"touchstart":"mousedown",A=l?"touchmove":"mousemove",C=l?"touchend touchcancel":"mouseup",D=u?"pointerdown":x,I=u?"pointermove":A,M=u?"pointerup pointercancel":C,T=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,F=/^data:/,k=/^data:image\/jpeg;base64,/,E=/^img|canvas$/i,B={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},O=Number.isNaN||h.isNaN;function R(t){return"number"==typeof t&&!O(t)}var j=function(t){return t>0&&t<1/0};function L(t){return void 0===t}function S(e){return"object"===t(e)&&null!==e}var P=Object.prototype.hasOwnProperty;function z(t){if(!S(t))return!1;try{var e=t.constructor,i=e.prototype;return e&&i&&P.call(i,"isPrototypeOf")}catch(t){return!1}}function H(t){return"function"==typeof t}var N=Array.prototype.slice;function U(t){return Array.from?Array.from(t):N.call(t)}function _(t,e){return t&&H(e)&&(Array.isArray(t)||R(t.length)?U(t).forEach((function(i,a){e.call(t,i,a,t)})):S(t)&&Object.keys(t).forEach((function(i){e.call(t,t[i],i,t)}))),t}var W=Object.assign||function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];return S(t)&&i.length>0&&i.forEach((function(e){S(e)&&Object.keys(e).forEach((function(i){t[i]=e[i]}))})),t},X=/\.\d*(?:0|9){12}\d*$/;function q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return X.test(t)?Math.round(t*e)/e:t}var Y=/^width|height|left|top|marginLeft|marginTop$/;function G(t,e){var i=t.style;_(e,(function(t,e){Y.test(e)&&R(t)&&(t="".concat(t,"px")),i[e]=t}))}function $(t,e){if(e)if(R(t.length))_(t,(function(t){$(t,e)}));else if(t.classList)t.classList.add(e);else{var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function K(t,e){e&&(R(t.length)?_(t,(function(t){K(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function Q(t,e,i){e&&(R(t.length)?_(t,(function(t){Q(t,e,i)})):i?$(t,e):K(t,e))}var V=/([a-z\d])([A-Z])/g;function J(t){return t.replace(V,"$1-$2").toLowerCase()}function Z(t,e){return S(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(J(e)))}function tt(t,e,i){S(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(J(e)),i)}var et=/\s\s*/,it=function(){var t=!1;if(c){var e=!1,i=function(){},a=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(t){e=t}});h.addEventListener("test",i,a),h.removeEventListener("test",i,a)}return t}();function at(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=i;e.trim().split(et).forEach((function(e){if(!it){var r=t.listeners;r&&r[e]&&r[e][i]&&(n=r[e][i],delete r[e][i],0===Object.keys(r[e]).length&&delete r[e],0===Object.keys(r).length&&delete t.listeners)}t.removeEventListener(e,n,a)}))}function nt(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=i;e.trim().split(et).forEach((function(e){if(a.once&&!it){var r=t.listeners,o=void 0===r?{}:r;n=function(){delete o[e][i],t.removeEventListener(e,n,a);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];i.apply(t,s)},o[e]||(o[e]={}),o[e][i]&&t.removeEventListener(e,o[e][i],a),o[e][i]=n,t.listeners=o}t.addEventListener(e,n,a)}))}function rt(t,e,i){var a;return H(Event)&&H(CustomEvent)?a=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,i),t.dispatchEvent(a)}function ot(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var st=h.location,ct=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function ht(t){var e=t.match(ct);return null!==e&&(e[1]!==st.protocol||e[2]!==st.hostname||e[3]!==st.port)}function lt(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function ut(t){var e=t.rotate,i=t.scaleX,a=t.scaleY,n=t.translateX,r=t.translateY,o=[];R(n)&&0!==n&&o.push("translateX(".concat(n,"px)")),R(r)&&0!==r&&o.push("translateY(".concat(r,"px)")),R(e)&&0!==e&&o.push("rotate(".concat(e,"deg)")),R(i)&&1!==i&&o.push("scaleX(".concat(i,")")),R(a)&&1!==a&&o.push("scaleY(".concat(a,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function dt(t,e){var i=t.pageX,a=t.pageY,n={endX:i,endY:a};return e?n:r({startX:i,startY:a},n)}function pt(t){var e=t.aspectRatio,i=t.height,a=t.width,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",r=j(a),o=j(i);if(r&&o){var s=i*e;"contain"===n&&s>a||"cover"===n&&s<a?i=a/e:a=i*e}else r?i=a/e:o&&(a=i*e);return{width:a,height:i}}function ft(t,e,i,a){var n=e.aspectRatio,r=e.naturalWidth,s=e.naturalHeight,c=e.rotate,h=void 0===c?0:c,l=e.scaleX,u=void 0===l?1:l,d=e.scaleY,p=void 0===d?1:d,f=i.aspectRatio,m=i.naturalWidth,g=i.naturalHeight,v=a.fillColor,y=void 0===v?"transparent":v,w=a.imageSmoothingEnabled,b=void 0===w||w,x=a.imageSmoothingQuality,A=void 0===x?"low":x,C=a.maxWidth,D=void 0===C?1/0:C,I=a.maxHeight,M=void 0===I?1/0:I,T=a.minWidth,F=void 0===T?0:T,k=a.minHeight,E=void 0===k?0:k,B=document.createElement("canvas"),O=B.getContext("2d"),R=pt({aspectRatio:f,width:D,height:M}),j=pt({aspectRatio:f,width:F,height:E},"cover"),L=Math.min(R.width,Math.max(j.width,m)),S=Math.min(R.height,Math.max(j.height,g)),P=pt({aspectRatio:n,width:D,height:M}),z=pt({aspectRatio:n,width:F,height:E},"cover"),H=Math.min(P.width,Math.max(z.width,r)),N=Math.min(P.height,Math.max(z.height,s)),U=[-H/2,-N/2,H,N];return B.width=q(L),B.height=q(S),O.fillStyle=y,O.fillRect(0,0,L,S),O.save(),O.translate(L/2,S/2),O.rotate(h*Math.PI/180),O.scale(u,p),O.imageSmoothingEnabled=b,O.imageSmoothingQuality=A,O.drawImage.apply(O,[t].concat(o(U.map((function(t){return Math.floor(q(t))}))))),O.restore(),B}var mt=String.fromCharCode,gt=/^data:.*,/;function vt(t){var e,i=new DataView(t);try{var a,n,r;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var o=i.byteLength,s=2;s+1<o;){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){n=s;break}s+=1}if(n){var c=n+10;if("Exif"===function(t,e,i){var a="";i+=e;for(var n=e;n<i;n+=1)a+=mt(t.getUint8(n));return a}(i,n+4,4)){var h=i.getUint16(c);if(((a=18761===h)||19789===h)&&42===i.getUint16(c+2,a)){var l=i.getUint32(c+4,a);l>=8&&(r=c+l)}}}if(r){var u,d,p=i.getUint16(r,a);for(d=0;d<p;d+=1)if(u=r+12*d+2,274===i.getUint16(u,a)){u+=8,e=i.getUint16(u,a),i.setUint16(u,1,a);break}}}catch(t){e=1}return e}var yt={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,e=this.options,i=this.container,a=this.cropper,n=Number(e.minContainerWidth),r=Number(e.minContainerHeight);$(a,f),K(t,f);var o={width:Math.max(i.offsetWidth,n>=0?n:200),height:Math.max(i.offsetHeight,r>=0?r:100)};this.containerData=o,G(a,{width:o.width,height:o.height}),$(t,f),K(a,f)},initCanvas:function(){var t=this.containerData,e=this.imageData,i=this.options.viewMode,a=Math.abs(e.rotate)%180==90,n=a?e.naturalHeight:e.naturalWidth,r=a?e.naturalWidth:e.naturalHeight,o=n/r,s=t.width,c=t.height;t.height*o>t.width?3===i?s=t.height*o:c=t.width/o:3===i?c=t.width/o:s=t.height*o;var h={aspectRatio:o,naturalWidth:n,naturalHeight:r,width:s,height:c};this.canvasData=h,this.limited=1===i||2===i,this.limitCanvas(!0,!0),h.width=Math.min(Math.max(h.width,h.minWidth),h.maxWidth),h.height=Math.min(Math.max(h.height,h.minHeight),h.maxHeight),h.left=(t.width-h.width)/2,h.top=(t.height-h.height)/2,h.oldLeft=h.left,h.oldTop=h.top,this.initialCanvasData=W({},h)},limitCanvas:function(t,e){var i=this.options,a=this.containerData,n=this.canvasData,r=this.cropBoxData,o=i.viewMode,s=n.aspectRatio,c=this.cropped&&r;if(t){var h=Number(i.minCanvasWidth)||0,l=Number(i.minCanvasHeight)||0;o>1?(h=Math.max(h,a.width),l=Math.max(l,a.height),3===o&&(l*s>h?h=l*s:l=h/s)):o>0&&(h?h=Math.max(h,c?r.width:0):l?l=Math.max(l,c?r.height:0):c&&(h=r.width,(l=r.height)*s>h?h=l*s:l=h/s));var u=pt({aspectRatio:s,width:h,height:l});h=u.width,l=u.height,n.minWidth=h,n.minHeight=l,n.maxWidth=1/0,n.maxHeight=1/0}if(e)if(o>(c?0:1)){var d=a.width-n.width,p=a.height-n.height;n.minLeft=Math.min(0,d),n.minTop=Math.min(0,p),n.maxLeft=Math.max(0,d),n.maxTop=Math.max(0,p),c&&this.limited&&(n.minLeft=Math.min(r.left,r.left+(r.width-n.width)),n.minTop=Math.min(r.top,r.top+(r.height-n.height)),n.maxLeft=r.left,n.maxTop=r.top,2===o&&(n.width>=a.width&&(n.minLeft=Math.min(0,d),n.maxLeft=Math.max(0,d)),n.height>=a.height&&(n.minTop=Math.min(0,p),n.maxTop=Math.max(0,p))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=a.width,n.maxTop=a.height},renderCanvas:function(t,e){var i=this.canvasData,a=this.imageData;if(e){var n=function(t){var e=t.width,i=t.height,a=t.degree;if(90==(a=Math.abs(a)%180))return{width:i,height:e};var n=a%90*Math.PI/180,r=Math.sin(n),o=Math.cos(n),s=e*o+i*r,c=e*r+i*o;return a>90?{width:c,height:s}:{width:s,height:c}}({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),r=n.width,o=n.height,s=i.width*(r/i.naturalWidth),c=i.height*(o/i.naturalHeight);i.left-=(s-i.width)/2,i.top-=(c-i.height)/2,i.width=s,i.height=c,i.aspectRatio=r/o,i.naturalWidth=r,i.naturalHeight=o,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,G(this.canvas,W({width:i.width,height:i.height},ut({translateX:i.left,translateY:i.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var e=this.canvasData,i=this.imageData,a=i.naturalWidth*(e.width/e.naturalWidth),n=i.naturalHeight*(e.height/e.naturalHeight);W(i,{width:a,height:n,left:(e.width-a)/2,top:(e.height-n)/2}),G(this.image,W({width:i.width,height:i.height},ut(W({translateX:i.left,translateY:i.top},i)))),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvasData,i=t.aspectRatio||t.initialAspectRatio,a=Number(t.autoCropArea)||.8,n={width:e.width,height:e.height};i&&(e.height*i>e.width?n.height=n.width/i:n.width=n.height*i),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*a),n.height=Math.max(n.minHeight,n.height*a),n.left=e.left+(e.width-n.width)/2,n.top=e.top+(e.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=W({},n)},limitCropBox:function(t,e){var i=this.options,a=this.containerData,n=this.canvasData,r=this.cropBoxData,o=this.limited,s=i.aspectRatio;if(t){var c=Number(i.minCropBoxWidth)||0,h=Number(i.minCropBoxHeight)||0,l=o?Math.min(a.width,n.width,n.width+n.left,a.width-n.left):a.width,u=o?Math.min(a.height,n.height,n.height+n.top,a.height-n.top):a.height;c=Math.min(c,a.width),h=Math.min(h,a.height),s&&(c&&h?h*s>c?h=c/s:c=h*s:c?h=c/s:h&&(c=h*s),u*s>l?u=l/s:l=u*s),r.minWidth=Math.min(c,l),r.minHeight=Math.min(h,u),r.maxWidth=l,r.maxHeight=u}e&&(o?(r.minLeft=Math.max(0,n.left),r.minTop=Math.max(0,n.top),r.maxLeft=Math.min(a.width,n.left+n.width)-r.width,r.maxTop=Math.min(a.height,n.top+n.height)-r.height):(r.minLeft=0,r.minTop=0,r.maxLeft=a.width-r.width,r.maxTop=a.height-r.height))},renderCropBox:function(){var t=this.options,e=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,t.movable&&t.cropBoxMovable&&tt(this.face,w,i.width>=e.width&&i.height>=e.height?"move":"all"),G(this.cropBox,W({width:i.width,height:i.height},ut({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),rt(this.element,"crop",this.getData())}},wt={initPreview:function(){var t=this.element,e=this.crossOrigin,i=this.options.preview,a=e?this.crossOriginUrl:this.url,n=t.alt||"The image to preview",r=document.createElement("img");if(e&&(r.crossOrigin=e),r.src=a,r.alt=n,this.viewBox.appendChild(r),this.viewBoxImage=r,i){var o=i;"string"==typeof i?o=t.ownerDocument.querySelectorAll(i):i.querySelector&&(o=[i]),this.previews=o,_(o,(function(t){var i=document.createElement("img");tt(t,b,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),e&&(i.crossOrigin=e),i.src=a,i.alt=n,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',t.innerHTML="",t.appendChild(i)}))}},resetPreview:function(){_(this.previews,(function(t){var e=Z(t,b);G(t,{width:e.width,height:e.height}),t.innerHTML=e.html,function(t,e){if(S(t[e]))try{delete t[e]}catch(i){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(i){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(J(e)))}(t,b)}))},preview:function(){var t=this.imageData,e=this.canvasData,i=this.cropBoxData,a=i.width,n=i.height,r=t.width,o=t.height,s=i.left-e.left-t.left,c=i.top-e.top-t.top;this.cropped&&!this.disabled&&(G(this.viewBoxImage,W({width:r,height:o},ut(W({translateX:-s,translateY:-c},t)))),_(this.previews,(function(e){var i=Z(e,b),h=i.width,l=i.height,u=h,d=l,p=1;a&&(d=n*(p=h/a)),n&&d>l&&(u=a*(p=l/n),d=l),G(e,{width:u,height:d}),G(e.getElementsByTagName("img")[0],W({width:r*p,height:o*p},ut(W({translateX:-s*p,translateY:-c*p},t))))})))}},bt={bind:function(){var t=this.element,e=this.options,i=this.cropper;H(e.cropstart)&&nt(t,"cropstart",e.cropstart),H(e.cropmove)&&nt(t,"cropmove",e.cropmove),H(e.cropend)&&nt(t,"cropend",e.cropend),H(e.crop)&&nt(t,"crop",e.crop),H(e.zoom)&&nt(t,"zoom",e.zoom),nt(i,D,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&nt(i,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&nt(i,"dblclick",this.onDblclick=this.dblclick.bind(this)),nt(t.ownerDocument,I,this.onCropMove=this.cropMove.bind(this)),nt(t.ownerDocument,M,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&nt(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,e=this.options,i=this.cropper;H(e.cropstart)&&at(t,"cropstart",e.cropstart),H(e.cropmove)&&at(t,"cropmove",e.cropmove),H(e.cropend)&&at(t,"cropend",e.cropend),H(e.crop)&&at(t,"crop",e.crop),H(e.zoom)&&at(t,"zoom",e.zoom),at(i,D,this.onCropStart),e.zoomable&&e.zoomOnWheel&&at(i,"wheel",this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&at(i,"dblclick",this.onDblclick),at(t.ownerDocument,I,this.onCropMove),at(t.ownerDocument,M,this.onCropEnd),e.responsive&&at(window,"resize",this.onResize)}},xt={resize:function(){if(!this.disabled){var t,e,i=this.options,a=this.container,n=this.containerData,r=a.offsetWidth/n.width;1===r&&a.offsetHeight===n.height||(i.restore&&(t=this.getCanvasData(),e=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(_(t,(function(e,i){t[i]=e*r}))),this.setCropBoxData(_(e,(function(t,i){e[i]=t*r})))))}},dblclick:function(){var t,e;this.disabled||"none"===this.options.dragMode||this.setDragMode((t=this.dragBox,e=d,(t.classList?t.classList.contains(e):t.className.indexOf(e)>-1)?"move":"crop"))},wheel:function(t){var e=this,i=Number(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(t.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){e.wheeling=!1}),50),t.deltaY?a=t.deltaY>0?1:-1:t.wheelDelta?a=-t.wheelDelta/120:t.detail&&(a=t.detail>0?1:-1),this.zoom(-a*i,t)))},cropStart:function(t){var e=t.buttons,i=t.button;if(!(this.disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(R(e)&&1!==e||R(i)&&0!==i||t.ctrlKey))){var a,n=this.options,r=this.pointers;t.changedTouches?_(t.changedTouches,(function(t){r[t.identifier]=dt(t)})):r[t.pointerId||0]=dt(t),a=Object.keys(r).length>1&&n.zoomable&&n.zoomOnTouch?"zoom":Z(t.target,w),T.test(a)&&!1!==rt(this.element,"cropstart",{originalEvent:t,action:a})&&(t.preventDefault(),this.action=a,this.cropping=!1,"crop"===a&&(this.cropping=!0,$(this.dragBox,v)))}},cropMove:function(t){var e=this.action;if(!this.disabled&&e){var i=this.pointers;t.preventDefault(),!1!==rt(this.element,"cropmove",{originalEvent:t,action:e})&&(t.changedTouches?_(t.changedTouches,(function(t){W(i[t.identifier]||{},dt(t,!0))})):W(i[t.pointerId||0]||{},dt(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var e=this.action,i=this.pointers;t.changedTouches?_(t.changedTouches,(function(t){delete i[t.identifier]})):delete i[t.pointerId||0],e&&(t.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,Q(this.dragBox,v,this.cropped&&this.options.modal)),rt(this.element,"cropend",{originalEvent:t,action:e}))}}},At={change:function(t){var e,i=this.options,a=this.canvasData,n=this.containerData,o=this.cropBoxData,s=this.pointers,c=this.action,h=i.aspectRatio,l=o.left,u=o.top,d=o.width,p=o.height,m=l+d,g=u+p,v=0,y=0,w=n.width,b=n.height,x=!0;!h&&t.shiftKey&&(h=d&&p?d/p:1),this.limited&&(v=o.minLeft,y=o.minTop,w=v+Math.min(n.width,a.width,a.left+a.width),b=y+Math.min(n.height,a.height,a.top+a.height));var A=s[Object.keys(s)[0]],C={x:A.endX-A.startX,y:A.endY-A.startY},D=function(t){switch(t){case"e":m+C.x>w&&(C.x=w-m);break;case"w":l+C.x<v&&(C.x=v-l);break;case"n":u+C.y<y&&(C.y=y-u);break;case"s":g+C.y>b&&(C.y=b-g)}};switch(c){case"all":l+=C.x,u+=C.y;break;case"e":if(C.x>=0&&(m>=w||h&&(u<=y||g>=b))){x=!1;break}D("e"),(d+=C.x)<0&&(c="w",l-=d=-d),h&&(p=d/h,u+=(o.height-p)/2);break;case"n":if(C.y<=0&&(u<=y||h&&(l<=v||m>=w))){x=!1;break}D("n"),p-=C.y,u+=C.y,p<0&&(c="s",u-=p=-p),h&&(d=p*h,l+=(o.width-d)/2);break;case"w":if(C.x<=0&&(l<=v||h&&(u<=y||g>=b))){x=!1;break}D("w"),d-=C.x,l+=C.x,d<0&&(c="e",l-=d=-d),h&&(p=d/h,u+=(o.height-p)/2);break;case"s":if(C.y>=0&&(g>=b||h&&(l<=v||m>=w))){x=!1;break}D("s"),(p+=C.y)<0&&(c="n",u-=p=-p),h&&(d=p*h,l+=(o.width-d)/2);break;case"ne":if(h){if(C.y<=0&&(u<=y||m>=w)){x=!1;break}D("n"),p-=C.y,u+=C.y,d=p*h}else D("n"),D("e"),C.x>=0?m<w?d+=C.x:C.y<=0&&u<=y&&(x=!1):d+=C.x,C.y<=0?u>y&&(p-=C.y,u+=C.y):(p-=C.y,u+=C.y);d<0&&p<0?(c="sw",u-=p=-p,l-=d=-d):d<0?(c="nw",l-=d=-d):p<0&&(c="se",u-=p=-p);break;case"nw":if(h){if(C.y<=0&&(u<=y||l<=v)){x=!1;break}D("n"),p-=C.y,u+=C.y,d=p*h,l+=o.width-d}else D("n"),D("w"),C.x<=0?l>v?(d-=C.x,l+=C.x):C.y<=0&&u<=y&&(x=!1):(d-=C.x,l+=C.x),C.y<=0?u>y&&(p-=C.y,u+=C.y):(p-=C.y,u+=C.y);d<0&&p<0?(c="se",u-=p=-p,l-=d=-d):d<0?(c="ne",l-=d=-d):p<0&&(c="sw",u-=p=-p);break;case"sw":if(h){if(C.x<=0&&(l<=v||g>=b)){x=!1;break}D("w"),d-=C.x,l+=C.x,p=d/h}else D("s"),D("w"),C.x<=0?l>v?(d-=C.x,l+=C.x):C.y>=0&&g>=b&&(x=!1):(d-=C.x,l+=C.x),C.y>=0?g<b&&(p+=C.y):p+=C.y;d<0&&p<0?(c="ne",u-=p=-p,l-=d=-d):d<0?(c="se",l-=d=-d):p<0&&(c="nw",u-=p=-p);break;case"se":if(h){if(C.x>=0&&(m>=w||g>=b)){x=!1;break}D("e"),p=(d+=C.x)/h}else D("s"),D("e"),C.x>=0?m<w?d+=C.x:C.y>=0&&g>=b&&(x=!1):d+=C.x,C.y>=0?g<b&&(p+=C.y):p+=C.y;d<0&&p<0?(c="nw",u-=p=-p,l-=d=-d):d<0?(c="sw",l-=d=-d):p<0&&(c="ne",u-=p=-p);break;case"move":this.move(C.x,C.y),x=!1;break;case"zoom":this.zoom(function(t){var e=r({},t),i=0;return _(t,(function(t,a){delete e[a],_(e,(function(e){var a=Math.abs(t.startX-e.startX),n=Math.abs(t.startY-e.startY),r=Math.abs(t.endX-e.endX),o=Math.abs(t.endY-e.endY),s=Math.sqrt(a*a+n*n),c=(Math.sqrt(r*r+o*o)-s)/s;Math.abs(c)>Math.abs(i)&&(i=c)}))})),i}(s),t),x=!1;break;case"crop":if(!C.x||!C.y){x=!1;break}e=ot(this.cropper),l=A.startX-e.left,u=A.startY-e.top,d=o.minWidth,p=o.minHeight,C.x>0?c=C.y>0?"se":"ne":C.x<0&&(l-=d,c=C.y>0?"sw":"nw"),C.y<0&&(u-=p),this.cropped||(K(this.cropBox,f),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}x&&(o.width=d,o.height=p,o.left=l,o.top=u,this.action=c,this.renderCropBox()),_(s,(function(t){t.startX=t.endX,t.startY=t.endY}))}},Ct={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&$(this.dragBox,v),K(this.cropBox,f),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=W({},this.initialImageData),this.canvasData=W({},this.initialCanvasData),this.cropBoxData=W({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(W(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),K(this.dragBox,v),$(this.cropBox,f)),this},replace:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,_(this.previews,(function(e){e.getElementsByTagName("img")[0].src=t})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,K(this.cropper,p)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,$(this.cropper,p)),this},destroy:function(){var t=this.element;return t.cropper?(t.cropper=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,a=i.left,n=i.top;return this.moveTo(L(t)?t:a+Number(t),L(e)?e:n+Number(e))},moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,a=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(R(t)&&(i.left=t,a=!0),R(e)&&(i.top=e,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(t,e){var i=this.canvasData;return t=(t=Number(t))<0?1/(1-t):1+t,this.zoomTo(i.width*t/i.naturalWidth,null,e)},zoomTo:function(t,e,i){var a=this.options,n=this.canvasData,r=n.width,o=n.height,s=n.naturalWidth,c=n.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&a.zoomable){var h=s*t,l=c*t;if(!1===rt(this.element,"zoom",{ratio:t,oldRatio:r/s,originalEvent:i}))return this;if(i){var u=this.pointers,d=ot(this.cropper),p=u&&Object.keys(u).length?function(t){var e=0,i=0,a=0;return _(t,(function(t){var n=t.startX,r=t.startY;e+=n,i+=r,a+=1})),{pageX:e/=a,pageY:i/=a}}(u):{pageX:i.pageX,pageY:i.pageY};n.left-=(h-r)*((p.pageX-d.left-n.left)/r),n.top-=(l-o)*((p.pageY-d.top-n.top)/o)}else z(e)&&R(e.x)&&R(e.y)?(n.left-=(h-r)*((e.x-n.left)/r),n.top-=(l-o)*((e.y-n.top)/o)):(n.left-=(h-r)/2,n.top-=(l-o)/2);n.width=h,n.height=l,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return R(t=Number(t))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var e=this.imageData.scaleY;return this.scale(t,R(e)?e:1)},scaleY:function(t){var e=this.imageData.scaleX;return this.scale(R(e)?e:1,t)},scale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.imageData,a=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(R(t)&&(i.scaleX=t,a=!0),R(e)&&(i.scaleY=e,a=!0),a&&this.renderCanvas(!0,!0)),this},getData:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.options,a=this.imageData,n=this.canvasData,r=this.cropBoxData;if(this.ready&&this.cropped){t={x:r.left-n.left,y:r.top-n.top,width:r.width,height:r.height};var o=a.width/a.naturalWidth;if(_(t,(function(e,i){t[i]=e/o})),e){var s=Math.round(t.y+t.height),c=Math.round(t.x+t.width);t.x=Math.round(t.x),t.y=Math.round(t.y),t.width=c-t.x,t.height=s-t.y}}else t={x:0,y:0,width:0,height:0};return i.rotatable&&(t.rotate=a.rotate||0),i.scalable&&(t.scaleX=a.scaleX||1,t.scaleY=a.scaleY||1),t},setData:function(t){var e=this.options,i=this.imageData,a=this.canvasData,n={};if(this.ready&&!this.disabled&&z(t)){var r=!1;e.rotatable&&R(t.rotate)&&t.rotate!==i.rotate&&(i.rotate=t.rotate,r=!0),e.scalable&&(R(t.scaleX)&&t.scaleX!==i.scaleX&&(i.scaleX=t.scaleX,r=!0),R(t.scaleY)&&t.scaleY!==i.scaleY&&(i.scaleY=t.scaleY,r=!0)),r&&this.renderCanvas(!0,!0);var o=i.width/i.naturalWidth;R(t.x)&&(n.left=t.x*o+a.left),R(t.y)&&(n.top=t.y*o+a.top),R(t.width)&&(n.width=t.width*o),R(t.height)&&(n.height=t.height*o),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?W({},this.containerData):{}},getImageData:function(){return this.sized?W({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,e={};return this.ready&&_(["left","top","width","height","naturalWidth","naturalHeight"],(function(i){e[i]=t[i]})),e},setCanvasData:function(t){var e=this.canvasData,i=e.aspectRatio;return this.ready&&!this.disabled&&z(t)&&(R(t.left)&&(e.left=t.left),R(t.top)&&(e.top=t.top),R(t.width)?(e.width=t.width,e.height=t.width/i):R(t.height)&&(e.height=t.height,e.width=t.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,e=this.cropBoxData;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var e,i,a=this.cropBoxData,n=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&z(t)&&(R(t.left)&&(a.left=t.left),R(t.top)&&(a.top=t.top),R(t.width)&&t.width!==a.width&&(e=!0,a.width=t.width),R(t.height)&&t.height!==a.height&&(i=!0,a.height=t.height),n&&(e?a.height=a.width/n:i&&(a.width=a.height*n)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,i=ft(this.image,this.imageData,e,t);if(!this.cropped)return i;var a=this.getData(),n=a.x,r=a.y,s=a.width,c=a.height,h=i.width/Math.floor(e.naturalWidth);1!==h&&(n*=h,r*=h,s*=h,c*=h);var l=s/c,u=pt({aspectRatio:l,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),d=pt({aspectRatio:l,width:t.minWidth||0,height:t.minHeight||0},"cover"),p=pt({aspectRatio:l,width:t.width||(1!==h?i.width:s),height:t.height||(1!==h?i.height:c)}),f=p.width,m=p.height;f=Math.min(u.width,Math.max(d.width,f)),m=Math.min(u.height,Math.max(d.height,m));var g=document.createElement("canvas"),v=g.getContext("2d");g.width=q(f),g.height=q(m),v.fillStyle=t.fillColor||"transparent",v.fillRect(0,0,f,m);var y=t.imageSmoothingEnabled,w=void 0===y||y,b=t.imageSmoothingQuality;v.imageSmoothingEnabled=w,b&&(v.imageSmoothingQuality=b);var x,A,C,D,I,M,T=i.width,F=i.height,k=n,E=r;k<=-s||k>T?(k=0,x=0,C=0,I=0):k<=0?(C=-k,k=0,I=x=Math.min(T,s+k)):k<=T&&(C=0,I=x=Math.min(s,T-k)),x<=0||E<=-c||E>F?(E=0,A=0,D=0,M=0):E<=0?(D=-E,E=0,M=A=Math.min(F,c+E)):E<=F&&(D=0,M=A=Math.min(c,F-E));var B=[k,E,x,A];if(I>0&&M>0){var O=f/s;B.push(C*O,D*O,I*O,M*O)}return v.drawImage.apply(v,[i].concat(o(B.map((function(t){return Math.floor(q(t))}))))),g},setAspectRatio:function(t){var e=this.options;return this.disabled||L(t)||(e.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var e=this.options,i=this.dragBox,a=this.face;if(this.ready&&!this.disabled){var n="crop"===t,r=e.movable&&"move"===t;t=n||r?t:"none",e.dragMode=t,tt(i,w,t),Q(i,d,n),Q(i,y,r),e.cropBoxMovable||(tt(a,w,t),Q(a,d,n),Q(a,y,r))}return this}},Dt=h.Cropper,It=function(){function t(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e(this,t),!i||!E.test(i.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=i,this.options=W({},B,z(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var a,n,r;return a=t,r=[{key:"noConflict",value:function(){return window.Cropper=Dt,t}},{key:"setDefaults",value:function(t){W(B,z(t)&&t)}}],(n=[{key:"init",value:function(){var t,e=this.element,i=e.tagName.toLowerCase();if(!e.cropper){if(e.cropper=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}},{key:"load",value:function(t){var e=this;if(t){this.url=t,this.imageData={};var i=this.element,a=this.options;if(a.rotatable||a.scalable||(a.checkOrientation=!1),a.checkOrientation&&window.ArrayBuffer)if(F.test(t))k.test(t)?this.read((n=t.replace(gt,""),r=atob(n),o=new ArrayBuffer(r.length),_(s=new Uint8Array(o),(function(t,e){s[e]=r.charCodeAt(e)})),o)):this.clone();else{var n,r,o,s,c=new XMLHttpRequest,h=this.clone.bind(this);this.reloading=!0,this.xhr=c,c.onabort=h,c.onerror=h,c.ontimeout=h,c.onprogress=function(){"image/jpeg"!==c.getResponseHeader("content-type")&&c.abort()},c.onload=function(){e.read(c.response)},c.onloadend=function(){e.reloading=!1,e.xhr=null},a.checkCrossOrigin&&ht(t)&&i.crossOrigin&&(t=lt(t)),c.open("GET",t),c.responseType="arraybuffer",c.withCredentials="use-credentials"===i.crossOrigin,c.send()}else this.clone()}}},{key:"read",value:function(t){var e=this.options,i=this.imageData,a=vt(t),n=0,r=1,o=1;if(a>1){this.url=function(t,e){for(var i=[],a=new Uint8Array(t);a.length>0;)i.push(mt.apply(null,U(a.subarray(0,8192)))),a=a.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(i.join("")))}(t,"image/jpeg");var s=function(t){var e=0,i=1,a=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90}return{rotate:e,scaleX:i,scaleY:a}}(a);n=s.rotate,r=s.scaleX,o=s.scaleY}e.rotatable&&(i.rotate=n),e.scalable&&(i.scaleX=r,i.scaleY=o),this.clone()}},{key:"clone",value:function(){var t=this.element,e=this.url,i=t.crossOrigin,a=e;this.options.checkCrossOrigin&&ht(e)&&(i||(i="anonymous"),a=lt(e)),this.crossOrigin=i,this.crossOriginUrl=a;var n=document.createElement("img");i&&(n.crossOrigin=i),n.src=a||e,n.alt=t.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),$(n,m),t.parentNode.insertBefore(n,t.nextSibling)}},{key:"start",value:function(){var t=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var i=h.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(h.navigator.userAgent),a=function(e,i){W(t.imageData,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i}),t.initialImageData=W({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(!e.naturalWidth||i){var n=document.createElement("img"),r=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){a(n.width,n.height),i||r.removeChild(n)},n.src=e.src,i||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",r.appendChild(n))}else a(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var t=this.element,e=this.options,i=this.image,a=t.parentNode,n=document.createElement("div");n.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var r=n.querySelector(".".concat("cropper","-container")),o=r.querySelector(".".concat("cropper","-canvas")),s=r.querySelector(".".concat("cropper","-drag-box")),c=r.querySelector(".".concat("cropper","-crop-box")),h=c.querySelector(".".concat("cropper","-face"));this.container=a,this.cropper=r,this.canvas=o,this.dragBox=s,this.cropBox=c,this.viewBox=r.querySelector(".".concat("cropper","-view-box")),this.face=h,o.appendChild(i),$(t,f),a.insertBefore(r,t.nextSibling),this.isImg||K(i,m),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,$(c,f),e.guides||$(c.getElementsByClassName("".concat("cropper","-dashed")),f),e.center||$(c.getElementsByClassName("".concat("cropper","-center")),f),e.background&&$(r,"".concat("cropper","-bg")),e.highlight||$(h,g),e.cropBoxMovable&&($(h,y),tt(h,w,"all")),e.cropBoxResizable||($(c.getElementsByClassName("".concat("cropper","-line")),f),$(c.getElementsByClassName("".concat("cropper","-point")),f)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),H(e.ready)&&nt(t,"ready",e.ready,{once:!0}),rt(t,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),K(this.element,f))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&i(a.prototype,n),r&&i(a,r),t}();return W(It.prototype,yt,wt,bt,xt,At,Ct),It}()},DYG5:function(t,e,i){"use strict";var a=i("1aPi"),n=i("gDU4");e.a=function(t,e,i){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return Object(n.a)(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),Object(a.a)(t,e,{leading:r,maxWait:e,trailing:o})}},KaRW:function(t,e,i){"use strict";i.r(e),i.d(e,"launch",(function(){return E}));var a=i("fzZl"),n=i.n(a),r=i("Ctz4"),o=i.n(r),s=i("xeH2"),c=i.n(s),h=i("aGAf"),l=window.profileAppInit,u={upload:Object(h.f)("templateUpload"),thumb:Object(h.f)("templateThumb")},d="Неизвестная ошибка.",p="Изображение не удовлетворяет требованиям.",f="Неверный запрос.",m="Ошибка загрузки файла на сервер. Код: ",g="Ошибка создания превью. Код: ",v="Превью успешно создано",y="Не удалось получить размеры изображения",w="Ошибка инициализации",b=l.photo,x=250,A=350,C=5,D=170,I=238,M={url:"/users/".concat(l.user_id,"/profile-update-image/"),headers:{"X-CSRFToken":Object(h.c)()}},T=c()("#user-photo-upload"),F=(c()(".modal-header",T),c()(".modal-body",T)),k={init:function(){if(void 0!==l.user_id){var t=c.a.Deferred(),e=t;c.a.each(l.preload,(function(t,i){e=e.then((function(){return c.a.ajax({url:i,dataType:"script",cache:!0})}))})),e.done((function(){c()("a[href='#user-photo-upload']").click((function(){T.modal("toggle"),null===b&&k.uploadInit()})),T.one("shown.bs.modal",(function(){null!==b&&k.thumbInit(b)}))})).fail((function(){Object(h.a)(w,"error")})),t.resolve()}},uploadInit:function(){var t=document.getElementById("simple-btn");FileAPI.event.off(t,"change",k.uploadValidate),F.html(u.upload()),t=document.getElementById("simple-btn"),FileAPI.event.on(t,"change",k.uploadValidate)},uploadValidate:function(t){var e=FileAPI.getFiles(t);FileAPI.filterFiles(e,(function(t,e){if(/^image/.test(t.type)&&e)return e.width>=x&&e.height>=A&&t.size<=C*FileAPI.MB}),(function(t,i){t.length?k.uploadProgress(e[0]):Object(h.a)(p,"error")}))},enableLoadingState:function(){F.addClass("load-state")},disableLoadingState:function(){F.removeClass("load-state")},uploadProgress:function(t){var e=FileAPI.extend({},M,{files:{photo:t},upload:function(){k.enableLoadingState()},complete:function(e,i){if(e)k.uploadError(i);else{var a=JSON.parse(i.response);k.uploadSuccess(a,t)}}});FileAPI.upload(e)},uploadError:function(t){var e;switch(k.disableLoadingState(),t.status){case 500:e=d;break;case 403:e=f;break;default:e=t.response}Object(h.a)(m+e,"error")},uploadSuccess:function(t,e){1==t.success?FileAPI.getInfo(e,(function(e,i){e?Object(h.a)(y,"error"):(t.width=i.width,t.height=i.height,b=t,k.thumbInit(t))})):Object(h.a)(d,"error")},thumbInit:function(t){k.enableLoadingState(),t.url=t.url+"?"+(new Date).getTime(),k.cropperInit(t)},cropperInit:function(t){var e=F.width()-40,i=Math.min(t.width,e),a=Math.round(i/t.width*t.height);F.html(u.thumb({url:t.url,width:i,height:a}));var r=n()(F).call(F,".uploaded-img")[0];r.onload=function(){var t=new o.a(r,{viewMode:1,background:!0,responsive:!1,autoCropArea:1,aspectRatio:5/7,dragMode:"move",guides:!1,movable:!1,scalable:!1,rotatable:!1,zoomable:!1,zoomOnTouch:!1,zoomOnWheel:!1,minContainerWidth:250,minContainerHeight:250,offsetWidth:0,offsetHeight:0,minCropBoxWidth:D,minCropBoxHeight:I,ready:function(){n()(F).call(F,".-prev").click((function(){k.uploadInit()})),n()(F).call(F,".save-crop-data").click((function(){k.thumbDone(t)})),k.setCropBox(t),k.disableLoadingState()}})},r.src=t.url},thumbDone:function(t){t.disable();var e=k.getCropBox(t),i=c.a.extend({crop_data:!0},e),a=c.a.extend(!0,{},M,{method:"POST",dataType:"json",data:i});c.a.ajax(a).done((function(e){t.enable(),1==e.success?k.thumbSuccess(t,e):Object(h.a)(e.reason,"error")})).fail((function(e){t.enable(),Object(h.a)(g+e.statusText,"error")}))},getCropBox:function(t){return t.getData(!0)},setCropBox:function(t){if(void 0!==b.cropbox){var e=b.cropbox;t.setData(e)}},thumbSuccess:function(t,e){t.enable(),c()(".thumbnail-img img").attr("src",e.thumbnail),Object(h.a)(v),T.modal("hide")}};function E(){k.init()}},avNT:function(t,e,i){var a=i("n9AK"),n=i("cpF+");a({target:"Object",stat:!0,forced:Object.assign!==n},{assign:n})},cY0r:function(t,e,i){i("avNT");var a=i("j0PW");t.exports=a.Object.assign},"cpF+":function(t,e,i){"use strict";var a=i("5Jdw"),n=i("XU0c"),r=i("nKVx"),o=i("iYt3"),s=i("0foe"),c=i("quhl"),h=i("fDXD"),l=Object.assign,u=Object.defineProperty;t.exports=!l||n((function(){if(a&&1!==l({b:1},l(u({},"a",{enumerable:!0,get:function(){u(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol();return t[i]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=l({},t)[i]||"abcdefghijklmnopqrst"!=r(l({},e)).join("")}))?function(t,e){for(var i=c(t),n=arguments.length,l=1,u=o.f,d=s.f;n>l;)for(var p,f=h(arguments[l++]),m=u?r(f).concat(u(f)):r(f),g=m.length,v=0;g>v;)p=m[v++],a&&!d.call(f,p)||(i[p]=f[p]);return i}:l},lGT8:function(t,e,i){t.exports=i("w0Ba")},w0Ba:function(t,e,i){var a=i("cY0r");t.exports=a}}]);